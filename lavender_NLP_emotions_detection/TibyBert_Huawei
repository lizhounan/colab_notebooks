{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"TibyBert_Huawei","provenance":[{"file_id":"1S6RVp_waCmuyk6McSMsZ1AI0dGAFgI-H","timestamp":1606323007385},{"file_id":"1kla4oODToMFlR6LUb3YpOoKC9b-rJLx3","timestamp":1604782228079}],"mount_file_id":"1n5lK6gawYxRBs0PAcsT3S5M-XcLkghzA","authorship_tag":"ABX9TyPS36nsPdyqjnK3KA5Mgzwv"},"kernelspec":{"name":"python3","display_name":"Python 3"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"863202584a454689934298d9140b6f97":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_65a18e1940134f23928e341ac4300a47","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_1c613ef8fbf440d399052b0cd55fdf6d","IPY_MODEL_b76ce2931dea439aae61bfb7acbfa290"]}},"65a18e1940134f23928e341ac4300a47":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1c613ef8fbf440d399052b0cd55fdf6d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_e42d7414e109473a89ecef4797c044c0","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":109534,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":109534,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a2c939e42b1a4e858925b782a563e23a"}},"b76ce2931dea439aae61bfb7acbfa290":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_1b6e2b0aa9384556b909700b095c88aa","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 110k/110k [00:01&lt;00:00, 61.6kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c1127b30705f435eb193a067a7f2d8e2"}},"e42d7414e109473a89ecef4797c044c0":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"a2c939e42b1a4e858925b782a563e23a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1b6e2b0aa9384556b909700b095c88aa":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"c1127b30705f435eb193a067a7f2d8e2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ab754e4ffa0a4b9f91893415bcf09d47":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_b84eb90b1b3a4c4888806d92ab850aa0","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_fb4f36f042fa44539575b554e17d5d3b","IPY_MODEL_37585478c9574db38b8963b6d5ab8c1b"]}},"b84eb90b1b3a4c4888806d92ab850aa0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"fb4f36f042fa44539575b554e17d5d3b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_3e66c738bc8c4c4e82e58c3c22682bca","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":430,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":430,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_63bd1e53a7ba4c8a8e35dca0f6d2fc85"}},"37585478c9574db38b8963b6d5ab8c1b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_620384c014f84b9e9b838eadef2cf9d0","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 430/430 [00:02&lt;00:00, 147B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_1cb4a7d39ed4409e8098af1e779d2bf4"}},"3e66c738bc8c4c4e82e58c3c22682bca":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"63bd1e53a7ba4c8a8e35dca0f6d2fc85":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"620384c014f84b9e9b838eadef2cf9d0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"1cb4a7d39ed4409e8098af1e779d2bf4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8039617f380747818ebdfa668df396cd":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_d21bcbed536444d7b442e10057cdf213","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_3102c78e9d5149ee9dc380e4c3cf843c","IPY_MODEL_51658dc3d221452885ff9ad8952a4d20"]}},"d21bcbed536444d7b442e10057cdf213":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3102c78e9d5149ee9dc380e4c3cf843c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_795fde11b600487292734511a3f2ee4e","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":47138484,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":47138484,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_8ac6c9d1fbce4afc9ea2f973479cae0a"}},"51658dc3d221452885ff9ad8952a4d20":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_c81b470789a74d1dae2021b0ea598813","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 47.1M/47.1M [00:02&lt;00:00, 21.0MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a4481840e5bc459482b846c00dbc10f4"}},"795fde11b600487292734511a3f2ee4e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"8ac6c9d1fbce4afc9ea2f973479cae0a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c81b470789a74d1dae2021b0ea598813":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"a4481840e5bc459482b846c00dbc10f4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"86d4bddba630444da790129b900992b1":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_090a2ae208cf4f5db212049017273fdc","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_89edab44463e4042b112f250e60a71b3","IPY_MODEL_45ab4286a5c649bd9dd60debd09e2317"]}},"090a2ae208cf4f5db212049017273fdc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"89edab44463e4042b112f250e60a71b3":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_550b6034e0f5402c81ed9ba1e19f85da","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":481,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":481,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_9b43e43c2b0749c89edfb1be014155b1"}},"45ab4286a5c649bd9dd60debd09e2317":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_077419a2940e4521aabfc152f60a198b","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 481/481 [00:03&lt;00:00, 134B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d47c5a09da83428ead454907f0f4019b"}},"550b6034e0f5402c81ed9ba1e19f85da":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"9b43e43c2b0749c89edfb1be014155b1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"077419a2940e4521aabfc152f60a198b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"d47c5a09da83428ead454907f0f4019b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9afa87cfbfff4eba89df580f61c5c014":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_992169a6839040b29e0e8421d4361efa","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_d5904b8e39fc42ba822e758aaa4102dc","IPY_MODEL_b565520dfcb64c5cb222ff32dc179333"]}},"992169a6839040b29e0e8421d4361efa":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d5904b8e39fc42ba822e758aaa4102dc":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_c1597cab620043d8b3a753e0bfcb7a61","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":231508,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":231508,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_e01e23f38ab247ec959fd61aa0013ff3"}},"b565520dfcb64c5cb222ff32dc179333":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_0d8358656442434bbfc70a77622b8d62","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 232k/232k [00:01&lt;00:00, 156kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_31c3694bdad142edbdb6e270958ec9c7"}},"c1597cab620043d8b3a753e0bfcb7a61":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"e01e23f38ab247ec959fd61aa0013ff3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0d8358656442434bbfc70a77622b8d62":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"31c3694bdad142edbdb6e270958ec9c7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4764709133b44f8d9621c14e0467e4e8":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_8fa670f9a7f54f18b2c66cca989eb31e","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_b991d92741ef4234b1b7cfa41fcf8c3a","IPY_MODEL_7e63273485e242d5b5f4b7725506ea85"]}},"8fa670f9a7f54f18b2c66cca989eb31e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b991d92741ef4234b1b7cfa41fcf8c3a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_8b439b73f473446e831dbe0330e1e32e","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":112,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":112,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_5933d1b018ae407c95fa87b63a211689"}},"7e63273485e242d5b5f4b7725506ea85":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_0e4845a7ad4340c5a5c3ad417aaebbe2","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 112/112 [00:01&lt;00:00, 90.1B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_892cc726a3944058b4c485780f1f6a00"}},"8b439b73f473446e831dbe0330e1e32e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"5933d1b018ae407c95fa87b63a211689":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0e4845a7ad4340c5a5c3ad417aaebbe2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"892cc726a3944058b4c485780f1f6a00":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3b4de40e47634b5ca071c885392aa615":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_94457c3c3d794962b8068b302dfad026","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_efb5214829e44bfe9f9c11dee99816e0","IPY_MODEL_cb7086b1bc3e4ca1b21b50643e63af01"]}},"94457c3c3d794962b8068b302dfad026":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"efb5214829e44bfe9f9c11dee99816e0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_c9d9fe5425514cea97a10a967addbf8f","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":48,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":48,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_20e2392a87d9424b9839272aa4d305c3"}},"cb7086b1bc3e4ca1b21b50643e63af01":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_db90608057b640f88ddd3187d04d68d8","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 48.0/48.0 [00:00&lt;00:00, 111B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_3f9cbba31d464e3c85fbf9ed0b07a80d"}},"c9d9fe5425514cea97a10a967addbf8f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"20e2392a87d9424b9839272aa4d305c3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"db90608057b640f88ddd3187d04d68d8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"3f9cbba31d464e3c85fbf9ed0b07a80d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"13c054eaac894ef8ba0a73bf471e05e6":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_017b9bc61fa3474da25f9a06d8050060","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_ac3f113e0ce94503af0c00e07810f23e","IPY_MODEL_73a3cada3721418698d457e8d54ec0a7"]}},"017b9bc61fa3474da25f9a06d8050060":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ac3f113e0ce94503af0c00e07810f23e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_a4e6e334600f4e06a5dbe339e21cc75f","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":62747391,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":62747391,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_775033ffc963478585777d3cd160097f"}},"73a3cada3721418698d457e8d54ec0a7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_0d3fff1ecf244824b426b1b68d0b412e","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 62.7M/62.7M [00:02&lt;00:00, 21.7MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_5ff65e5c38e5488b89844e9f3c34be8b"}},"a4e6e334600f4e06a5dbe339e21cc75f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"775033ffc963478585777d3cd160097f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0d3fff1ecf244824b426b1b68d0b412e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"5ff65e5c38e5488b89844e9f3c34be8b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7129ed69b7ee4d8a8dd493dad5292d73":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_09cbafb0d373481b90d3581e08f2ef25","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_629f098fd7684a119dcd7b9672d9b738","IPY_MODEL_973b1ae5c1ff485fa9bd47048c6e3fb0"]}},"09cbafb0d373481b90d3581e08f2ef25":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"629f098fd7684a119dcd7b9672d9b738":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_ad1e1738aee64e70940da2baee2879b3","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":109534,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":109534,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_092642fecf0e484b923deb24ea51e06e"}},"973b1ae5c1ff485fa9bd47048c6e3fb0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_88d8df63d2b344e6afd0bce5098a5b25","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 110k/110k [00:01&lt;00:00, 63.6kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_17ea96429841424e8123221cea6c397b"}},"ad1e1738aee64e70940da2baee2879b3":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"092642fecf0e484b923deb24ea51e06e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"88d8df63d2b344e6afd0bce5098a5b25":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"17ea96429841424e8123221cea6c397b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1d9525281e214dfeb19eabd723467a8a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_ba7b929725244ff9823526986bad7279","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_17ae39d946904734a7774f00bfaad12b","IPY_MODEL_d266b23198194eb88e6ae251fc1ebf17"]}},"ba7b929725244ff9823526986bad7279":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"17ae39d946904734a7774f00bfaad12b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_0f55921f5268488082e25b1d57264d47","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":475,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":475,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a977fddbba814c2d9e608c1097c8f4c5"}},"d266b23198194eb88e6ae251fc1ebf17":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ceeddd48b6b4405bb8e6914f8301bd06","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 475/475 [01:05&lt;00:00, 7.21B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_39a76ec139774e85b1fabc084e3bc748"}},"0f55921f5268488082e25b1d57264d47":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"a977fddbba814c2d9e608c1097c8f4c5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ceeddd48b6b4405bb8e6914f8301bd06":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"39a76ec139774e85b1fabc084e3bc748":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1331333cda9c4b97bd3de4ec193cc005":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_c1ed4e8b063a41319c448cb9f7af4bc8","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_9f21d8b71c564c18b91a72081c605de1","IPY_MODEL_f86fd085242d4880ae5c8ef0b76c4f0d"]}},"c1ed4e8b063a41319c448cb9f7af4bc8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9f21d8b71c564c18b91a72081c605de1":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_7bd3fcd870ef4b9dae0ed1d46eb66e4b","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":59499772,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":59499772,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a589983ad7bc4354892e0193bf4534ee"}},"f86fd085242d4880ae5c8ef0b76c4f0d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_06267a26e37542e3b1b2aa9f491896ab","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 59.5M/59.5M [00:02&lt;00:00, 22.0MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_03c88c3c1283439899ba967956610756"}},"7bd3fcd870ef4b9dae0ed1d46eb66e4b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"a589983ad7bc4354892e0193bf4534ee":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"06267a26e37542e3b1b2aa9f491896ab":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"03c88c3c1283439899ba967956610756":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"code","metadata":{"id":"_KUrB5FcgR4w","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1606358876158,"user_tz":300,"elapsed":7588,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"bacee3b7-6354-4b4c-83f4-07db12719871"},"source":["!pip install transformers==3.0.2"],"execution_count":1,"outputs":[{"output_type":"stream","text":["Collecting transformers==3.0.2\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/27/3c/91ed8f5c4e7ef3227b4119200fc0ed4b4fd965b1f0172021c25701087825/transformers-3.0.2-py3-none-any.whl (769kB)\n","\r\u001b[K     |▍                               | 10kB 17.5MB/s eta 0:00:01\r\u001b[K     |▉                               | 20kB 23.9MB/s eta 0:00:01\r\u001b[K     |█▎                              | 30kB 25.4MB/s eta 0:00:01\r\u001b[K     |█▊                              | 40kB 18.9MB/s eta 0:00:01\r\u001b[K     |██▏                             | 51kB 15.6MB/s eta 0:00:01\r\u001b[K     |██▋                             | 61kB 17.5MB/s eta 0:00:01\r\u001b[K     |███                             | 71kB 15.2MB/s eta 0:00:01\r\u001b[K     |███▍                            | 81kB 15.7MB/s eta 0:00:01\r\u001b[K     |███▉                            | 92kB 14.8MB/s eta 0:00:01\r\u001b[K     |████▎                           | 102kB 13.4MB/s eta 0:00:01\r\u001b[K     |████▊                           | 112kB 13.4MB/s eta 0:00:01\r\u001b[K     |█████▏                          | 122kB 13.4MB/s eta 0:00:01\r\u001b[K     |█████▌                          | 133kB 13.4MB/s eta 0:00:01\r\u001b[K     |██████                          | 143kB 13.4MB/s eta 0:00:01\r\u001b[K     |██████▍                         | 153kB 13.4MB/s eta 0:00:01\r\u001b[K     |██████▉                         | 163kB 13.4MB/s eta 0:00:01\r\u001b[K     |███████▎                        | 174kB 13.4MB/s eta 0:00:01\r\u001b[K     |███████▊                        | 184kB 13.4MB/s eta 0:00:01\r\u001b[K     |████████                        | 194kB 13.4MB/s eta 0:00:01\r\u001b[K     |████████▌                       | 204kB 13.4MB/s eta 0:00:01\r\u001b[K     |█████████                       | 215kB 13.4MB/s eta 0:00:01\r\u001b[K     |█████████▍                      | 225kB 13.4MB/s eta 0:00:01\r\u001b[K     |█████████▉                      | 235kB 13.4MB/s eta 0:00:01\r\u001b[K     |██████████▎                     | 245kB 13.4MB/s eta 0:00:01\r\u001b[K     |██████████▋                     | 256kB 13.4MB/s eta 0:00:01\r\u001b[K     |███████████                     | 266kB 13.4MB/s eta 0:00:01\r\u001b[K     |███████████▌                    | 276kB 13.4MB/s eta 0:00:01\r\u001b[K     |████████████                    | 286kB 13.4MB/s eta 0:00:01\r\u001b[K     |████████████▍                   | 296kB 13.4MB/s eta 0:00:01\r\u001b[K     |████████████▉                   | 307kB 13.4MB/s eta 0:00:01\r\u001b[K     |█████████████▏                  | 317kB 13.4MB/s eta 0:00:01\r\u001b[K     |█████████████▋                  | 327kB 13.4MB/s eta 0:00:01\r\u001b[K     |██████████████                  | 337kB 13.4MB/s eta 0:00:01\r\u001b[K     |██████████████▌                 | 348kB 13.4MB/s eta 0:00:01\r\u001b[K     |███████████████                 | 358kB 13.4MB/s eta 0:00:01\r\u001b[K     |███████████████▍                | 368kB 13.4MB/s eta 0:00:01\r\u001b[K     |███████████████▊                | 378kB 13.4MB/s eta 0:00:01\r\u001b[K     |████████████████▏               | 389kB 13.4MB/s eta 0:00:01\r\u001b[K     |████████████████▋               | 399kB 13.4MB/s eta 0:00:01\r\u001b[K     |█████████████████               | 409kB 13.4MB/s eta 0:00:01\r\u001b[K     |█████████████████▌              | 419kB 13.4MB/s eta 0:00:01\r\u001b[K     |██████████████████              | 430kB 13.4MB/s eta 0:00:01\r\u001b[K     |██████████████████▎             | 440kB 13.4MB/s eta 0:00:01\r\u001b[K     |██████████████████▊             | 450kB 13.4MB/s eta 0:00:01\r\u001b[K     |███████████████████▏            | 460kB 13.4MB/s eta 0:00:01\r\u001b[K     |███████████████████▋            | 471kB 13.4MB/s eta 0:00:01\r\u001b[K     |████████████████████            | 481kB 13.4MB/s eta 0:00:01\r\u001b[K     |████████████████████▌           | 491kB 13.4MB/s eta 0:00:01\r\u001b[K     |████████████████████▉           | 501kB 13.4MB/s eta 0:00:01\r\u001b[K     |█████████████████████▎          | 512kB 13.4MB/s eta 0:00:01\r\u001b[K     |█████████████████████▊          | 522kB 13.4MB/s eta 0:00:01\r\u001b[K     |██████████████████████▏         | 532kB 13.4MB/s eta 0:00:01\r\u001b[K     |██████████████████████▋         | 542kB 13.4MB/s eta 0:00:01\r\u001b[K     |███████████████████████         | 552kB 13.4MB/s eta 0:00:01\r\u001b[K     |███████████████████████▍        | 563kB 13.4MB/s eta 0:00:01\r\u001b[K     |███████████████████████▉        | 573kB 13.4MB/s eta 0:00:01\r\u001b[K     |████████████████████████▎       | 583kB 13.4MB/s eta 0:00:01\r\u001b[K     |████████████████████████▊       | 593kB 13.4MB/s eta 0:00:01\r\u001b[K     |█████████████████████████▏      | 604kB 13.4MB/s eta 0:00:01\r\u001b[K     |█████████████████████████▋      | 614kB 13.4MB/s eta 0:00:01\r\u001b[K     |██████████████████████████      | 624kB 13.4MB/s eta 0:00:01\r\u001b[K     |██████████████████████████▍     | 634kB 13.4MB/s eta 0:00:01\r\u001b[K     |██████████████████████████▉     | 645kB 13.4MB/s eta 0:00:01\r\u001b[K     |███████████████████████████▎    | 655kB 13.4MB/s eta 0:00:01\r\u001b[K     |███████████████████████████▊    | 665kB 13.4MB/s eta 0:00:01\r\u001b[K     |████████████████████████████▏   | 675kB 13.4MB/s eta 0:00:01\r\u001b[K     |████████████████████████████▌   | 686kB 13.4MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████   | 696kB 13.4MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████▍  | 706kB 13.4MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████▉  | 716kB 13.4MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████▎ | 727kB 13.4MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████▊ | 737kB 13.4MB/s eta 0:00:01\r\u001b[K     |███████████████████████████████ | 747kB 13.4MB/s eta 0:00:01\r\u001b[K     |███████████████████████████████▌| 757kB 13.4MB/s eta 0:00:01\r\u001b[K     |████████████████████████████████| 768kB 13.4MB/s eta 0:00:01\r\u001b[K     |████████████████████████████████| 778kB 13.4MB/s \n","\u001b[?25hRequirement already satisfied: packaging in /usr/local/lib/python3.6/dist-packages (from transformers==3.0.2) (20.4)\n","Requirement already satisfied: requests in /usr/local/lib/python3.6/dist-packages (from transformers==3.0.2) (2.23.0)\n","Collecting tokenizers==0.8.1.rc1\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/40/d0/30d5f8d221a0ed981a186c8eb986ce1c94e3a6e87f994eae9f4aa5250217/tokenizers-0.8.1rc1-cp36-cp36m-manylinux1_x86_64.whl (3.0MB)\n","\u001b[K     |████████████████████████████████| 3.0MB 30.8MB/s \n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.6/dist-packages (from transformers==3.0.2) (3.0.12)\n","Collecting sacremoses\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/7d/34/09d19aff26edcc8eb2a01bed8e98f13a1537005d31e95233fd48216eed10/sacremoses-0.0.43.tar.gz (883kB)\n","\u001b[K     |████████████████████████████████| 890kB 52.1MB/s \n","\u001b[?25hRequirement already satisfied: numpy in /usr/local/lib/python3.6/dist-packages (from transformers==3.0.2) (1.18.5)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.6/dist-packages (from transformers==3.0.2) (4.41.1)\n","Collecting sentencepiece!=0.1.92\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/e5/2d/6d4ca4bef9a67070fa1cac508606328329152b1df10bdf31fb6e4e727894/sentencepiece-0.1.94-cp36-cp36m-manylinux2014_x86_64.whl (1.1MB)\n","\u001b[K     |████████████████████████████████| 1.1MB 47.3MB/s \n","\u001b[?25hRequirement already satisfied: dataclasses; python_version < \"3.7\" in /usr/local/lib/python3.6/dist-packages (from transformers==3.0.2) (0.8)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.6/dist-packages (from transformers==3.0.2) (2019.12.20)\n","Requirement already satisfied: pyparsing>=2.0.2 in /usr/local/lib/python3.6/dist-packages (from packaging->transformers==3.0.2) (2.4.7)\n","Requirement already satisfied: six in /usr/local/lib/python3.6/dist-packages (from packaging->transformers==3.0.2) (1.15.0)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.6/dist-packages (from requests->transformers==3.0.2) (2.10)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.6/dist-packages (from requests->transformers==3.0.2) (2020.11.8)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.6/dist-packages (from requests->transformers==3.0.2) (3.0.4)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.6/dist-packages (from requests->transformers==3.0.2) (1.24.3)\n","Requirement already satisfied: click in /usr/local/lib/python3.6/dist-packages (from sacremoses->transformers==3.0.2) (7.1.2)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.6/dist-packages (from sacremoses->transformers==3.0.2) (0.17.0)\n","Building wheels for collected packages: sacremoses\n","  Building wheel for sacremoses (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for sacremoses: filename=sacremoses-0.0.43-cp36-none-any.whl size=893257 sha256=b65ea3a2aaee5de2b6006e6b4c1c5df71051cd5dfe6acefc43177ef5085e3a65\n","  Stored in directory: /root/.cache/pip/wheels/29/3c/fd/7ce5c3f0666dab31a50123635e6fb5e19ceb42ce38d4e58f45\n","Successfully built sacremoses\n","Installing collected packages: tokenizers, sacremoses, sentencepiece, transformers\n","Successfully installed sacremoses-0.0.43 sentencepiece-0.1.94 tokenizers-0.8.1rc1 transformers-3.0.2\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"bEJVI6W9gWvu","executionInfo":{"status":"ok","timestamp":1606358880629,"user_tz":300,"elapsed":12051,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}}},"source":["# Importing stock ml libraries\n","import warnings\n","warnings.simplefilter('ignore')\n","import numpy as np\n","import pandas as pd\n","from tqdm import tqdm\n","from sklearn import metrics\n","import transformers\n","import torch\n","from torch.utils.data import Dataset, DataLoader, RandomSampler, SequentialSampler\n","from transformers import MobileBertTokenizer, MobileBertModel\n","from transformers import AutoTokenizer, AutoModel, BertTokenizer, BertModel\n","\n","\n","import logging\n","logging.basicConfig(level=logging.ERROR)"],"execution_count":2,"outputs":[]},{"cell_type":"code","metadata":{"id":"s_DRWuvxgu2N","executionInfo":{"status":"ok","timestamp":1606358880630,"user_tz":300,"elapsed":12048,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}}},"source":["from torch import cuda\n","device = 'cuda' if cuda.is_available() else 'cpu'"],"execution_count":3,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"igZtC_28J0yP"},"source":["# **try to figure out the tiny bert output structure**"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":164,"referenced_widgets":["863202584a454689934298d9140b6f97","65a18e1940134f23928e341ac4300a47","1c613ef8fbf440d399052b0cd55fdf6d","b76ce2931dea439aae61bfb7acbfa290","e42d7414e109473a89ecef4797c044c0","a2c939e42b1a4e858925b782a563e23a","1b6e2b0aa9384556b909700b095c88aa","c1127b30705f435eb193a067a7f2d8e2","ab754e4ffa0a4b9f91893415bcf09d47","b84eb90b1b3a4c4888806d92ab850aa0","fb4f36f042fa44539575b554e17d5d3b","37585478c9574db38b8963b6d5ab8c1b","3e66c738bc8c4c4e82e58c3c22682bca","63bd1e53a7ba4c8a8e35dca0f6d2fc85","620384c014f84b9e9b838eadef2cf9d0","1cb4a7d39ed4409e8098af1e779d2bf4","8039617f380747818ebdfa668df396cd","d21bcbed536444d7b442e10057cdf213","3102c78e9d5149ee9dc380e4c3cf843c","51658dc3d221452885ff9ad8952a4d20","795fde11b600487292734511a3f2ee4e","8ac6c9d1fbce4afc9ea2f973479cae0a","c81b470789a74d1dae2021b0ea598813","a4481840e5bc459482b846c00dbc10f4"]},"id":"Ev_-I2gcP4XX","executionInfo":{"status":"ok","timestamp":1606321984475,"user_tz":300,"elapsed":6965,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"3cdb4f95-763e-4862-f5ca-906ff17bb352"},"source":["from transformers import AutoTokenizer, AutoModel\n","from transformers import BertTokenizer, BertModel\n","\n","tokenizer = BertTokenizer.from_pretrained(\"huawei-noah/TinyBERT_4L_zh\")\n","\n","model = BertModel.from_pretrained(\"huawei-noah/TinyBERT_4L_zh\")"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"863202584a454689934298d9140b6f97","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=109534.0, style=ProgressStyle(descripti…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"ab754e4ffa0a4b9f91893415bcf09d47","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=430.0, style=ProgressStyle(description_…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"8039617f380747818ebdfa668df396cd","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=47138484.0, style=ProgressStyle(descrip…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":262,"referenced_widgets":["86d4bddba630444da790129b900992b1","090a2ae208cf4f5db212049017273fdc","89edab44463e4042b112f250e60a71b3","45ab4286a5c649bd9dd60debd09e2317","550b6034e0f5402c81ed9ba1e19f85da","9b43e43c2b0749c89edfb1be014155b1","077419a2940e4521aabfc152f60a198b","d47c5a09da83428ead454907f0f4019b","9afa87cfbfff4eba89df580f61c5c014","992169a6839040b29e0e8421d4361efa","d5904b8e39fc42ba822e758aaa4102dc","b565520dfcb64c5cb222ff32dc179333","c1597cab620043d8b3a753e0bfcb7a61","e01e23f38ab247ec959fd61aa0013ff3","0d8358656442434bbfc70a77622b8d62","31c3694bdad142edbdb6e270958ec9c7","4764709133b44f8d9621c14e0467e4e8","8fa670f9a7f54f18b2c66cca989eb31e","b991d92741ef4234b1b7cfa41fcf8c3a","7e63273485e242d5b5f4b7725506ea85","8b439b73f473446e831dbe0330e1e32e","5933d1b018ae407c95fa87b63a211689","0e4845a7ad4340c5a5c3ad417aaebbe2","892cc726a3944058b4c485780f1f6a00","3b4de40e47634b5ca071c885392aa615","94457c3c3d794962b8068b302dfad026","efb5214829e44bfe9f9c11dee99816e0","cb7086b1bc3e4ca1b21b50643e63af01","c9d9fe5425514cea97a10a967addbf8f","20e2392a87d9424b9839272aa4d305c3","db90608057b640f88ddd3187d04d68d8","3f9cbba31d464e3c85fbf9ed0b07a80d","13c054eaac894ef8ba0a73bf471e05e6","017b9bc61fa3474da25f9a06d8050060","ac3f113e0ce94503af0c00e07810f23e","73a3cada3721418698d457e8d54ec0a7","a4e6e334600f4e06a5dbe339e21cc75f","775033ffc963478585777d3cd160097f","0d3fff1ecf244824b426b1b68d0b412e","5ff65e5c38e5488b89844e9f3c34be8b"]},"id":"9ExXw7cGLxg7","executionInfo":{"status":"ok","timestamp":1606320896381,"user_tz":300,"elapsed":9295,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"c7a93e76-6ba9-4538-d0fd-7d4834061f5c"},"source":["from transformers import AutoTokenizer, AutoModel\n","\n","tokenizer = AutoTokenizer.from_pretrained(\"nreimers/TinyBERT_L-4_H-312_v2\")\n","\n","model = AutoModel.from_pretrained(\"nreimers/TinyBERT_L-4_H-312_v2\")"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"86d4bddba630444da790129b900992b1","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=481.0, style=ProgressStyle(description_…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"9afa87cfbfff4eba89df580f61c5c014","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=231508.0, style=ProgressStyle(descripti…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"4764709133b44f8d9621c14e0467e4e8","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=112.0, style=ProgressStyle(description_…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"3b4de40e47634b5ca071c885392aa615","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=48.0, style=ProgressStyle(description_w…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"13c054eaac894ef8ba0a73bf471e05e6","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=62747391.0, style=ProgressStyle(descrip…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"WFNsGavSJ0EW"},"source":["from transformers import AutoTokenizer, AutoModel\n","\n","tokenizer = AutoTokenizer.from_pretrained(\"mrm8488/es-tinybert-v1\")\n","\n","model = AutoModel.from_pretrained(\"mrm8488/es-tinybert-v1\")"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"HdVEJuk6LWaU"},"source":["inputs = tokenizer.encode_plus(\n","            'I love lavender I love lavender I love lavender I love lavender',\n","            None,\n","            add_special_tokens=True,\n","            max_length=10,\n","            pad_to_max_length=True,\n","            return_token_type_ids=True\n","        )\n","ids = inputs['input_ids']\n","mask = inputs['attention_mask']\n","token_type_ids = inputs[\"token_type_ids\"]"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Fk90gAt-GFs3","executionInfo":{"status":"ok","timestamp":1606255293849,"user_tz":300,"elapsed":7191,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"88c0c9b8-8e1b-43a0-c4a3-2cc413530fa4"},"source":["ids"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[4, 1121, 10827, 6987, 5037, 1121, 10827, 6987, 5037, 5]"]},"metadata":{"tags":[]},"execution_count":61}]},{"cell_type":"code","metadata":{"id":"5MGbTogFA3Sg"},"source":["ids = torch.tensor(ids).unsqueeze(0)\n","mask = torch.tensor(mask).unsqueeze(0)\n","token_type_ids = torch.tensor(token_type_ids).unsqueeze(0)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"KJ5Gxws7K0uP"},"source":["output = model(input_ids=ids, attention_mask=mask, token_type_ids=token_type_ids)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"F8YswH9YNzhp","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1606255293851,"user_tz":300,"elapsed":6378,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"0484d416-e744-4071-ae5b-22a2d895dc3a"},"source":["output[0].shape"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([1, 10, 312])"]},"metadata":{"tags":[]},"execution_count":64}]},{"cell_type":"markdown","metadata":{"id":"_V4H7pkQLJS_"},"source":["we can see the output tensors shape is (768, )"]},{"cell_type":"markdown","metadata":{"id":"C38PYeAmH9PO"},"source":["# **load training data set**"]},{"cell_type":"code","metadata":{"id":"4l4Xii9uhzwl"},"source":["data = pd.read_csv('/content/drive/My Drive/goemotions_aug_dairai_train_cleaned.csv')\n","data.drop(['Unnamed: 0', 'datasource', 'augmented'], inplace=True, axis=1)\n","new_df = pd.DataFrame()\n","new_df['text'] = data['cleaned_processed']\n","new_df['labels'] = data[['anger', 'fear', 'joy', 'sadness']].values.astype('int').tolist()"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"wxDlbyRBIHep"},"source":["demo_df = new_df.sample(5000)"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"Ij4-qoXUIQeD"},"source":["# **create MultiLabel dataset using tokenizer**"]},{"cell_type":"code","metadata":{"id":"BeWWnUkPh7my","colab":{"base_uri":"https://localhost:8080/","height":66,"referenced_widgets":["7129ed69b7ee4d8a8dd493dad5292d73","09cbafb0d373481b90d3581e08f2ef25","629f098fd7684a119dcd7b9672d9b738","973b1ae5c1ff485fa9bd47048c6e3fb0","ad1e1738aee64e70940da2baee2879b3","092642fecf0e484b923deb24ea51e06e","88d8df63d2b344e6afd0bce5098a5b25","17ea96429841424e8123221cea6c397b"]},"executionInfo":{"status":"ok","timestamp":1606358903357,"user_tz":300,"elapsed":2994,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"b7fce0ed-a240-4e32-b236-f0ecc8d47705"},"source":["MAX_LEN = 100\n","TRAIN_BATCH_SIZE = 32\n","VALID_BATCH_SIZE = 32\n","EPOCHS = 1\n","LEARNING_RATE = 5e-5\n","tokenizer = BertTokenizer.from_pretrained(\"huawei-noah/TinyBERT_4L_zh\")"],"execution_count":12,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"7129ed69b7ee4d8a8dd493dad5292d73","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=109534.0, style=ProgressStyle(descripti…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"GNFWDV6PiY_H"},"source":["class MultiLabelDataset(Dataset):\n","\n","    def __init__(self, dataframe, tokenizer, max_len):\n","        self.tokenizer = tokenizer\n","        self.data = dataframe\n","        self.text = dataframe.text\n","        self.targets = self.data.labels\n","        self.max_len = max_len\n","\n","    def __len__(self):\n","        return len(self.text)\n","\n","    def __getitem__(self, index):\n","        text = str(self.text[index])\n","        text = \" \".join(text.split())\n","\n","        inputs = self.tokenizer.encode_plus(\n","            text,\n","            None,\n","            add_special_tokens=True,\n","            max_length=self.max_len,\n","            pad_to_max_length=True,\n","            return_token_type_ids=True\n","        )\n","        ids = inputs['input_ids']\n","        mask = inputs['attention_mask']\n","        token_type_ids = inputs[\"token_type_ids\"]\n","\n","\n","        return {\n","            'ids': torch.tensor(ids, dtype=torch.long),\n","            'mask': torch.tensor(mask, dtype=torch.long),\n","            'token_type_ids': torch.tensor(token_type_ids, dtype=torch.long),\n","            'targets': torch.tensor(self.targets[index], dtype=torch.float)\n","        }"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"LTpXraKWIiFi"},"source":["# **create dataloader from a dataset**"]},{"cell_type":"code","metadata":{"id":"gJYaofjxicAU","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1606255304978,"user_tz":300,"elapsed":1088,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"5066bce5-9940-425b-c05e-9a3b96c4d916"},"source":["train_size = 0.7\n","train_data=new_df.sample(frac=train_size,random_state=42)\n","test_data=new_df.drop(train_data.index).reset_index(drop=True)\n","train_data = train_data.reset_index(drop=True)\n","\n","\n","print(\"FULL Dataset: {}\".format(new_df.shape))\n","print(\"TRAIN Dataset: {}\".format(train_data.shape))\n","print(\"TEST Dataset: {}\".format(test_data.shape))\n","\n","training_set = MultiLabelDataset(train_data, tokenizer, MAX_LEN)\n","testing_set = MultiLabelDataset(test_data, tokenizer, MAX_LEN)"],"execution_count":null,"outputs":[{"output_type":"stream","text":["FULL Dataset: (460551, 2)\n","TRAIN Dataset: (322386, 2)\n","TEST Dataset: (138165, 2)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"Nsge4J6Iieg-"},"source":["train_params = {'batch_size': TRAIN_BATCH_SIZE,\n","                'shuffle': True,\n","                'num_workers': 0\n","                }\n","\n","test_params = {'batch_size': VALID_BATCH_SIZE,\n","                'shuffle': True,\n","                'num_workers': 0\n","                }\n","\n","training_loader = DataLoader(training_set, **train_params)\n","testing_loader = DataLoader(testing_set, **test_params)"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"soECdZglJ8E_"},"source":["# **Define customized class**"]},{"cell_type":"code","metadata":{"id":"--jCYtsCigfu","executionInfo":{"status":"ok","timestamp":1606358891893,"user_tz":300,"elapsed":1007,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}}},"source":["class TinyBERTClass(torch.nn.Module):\n","    def __init__(self):\n","        super(TinyBERTClass, self).__init__()\n","        self.l1 = BertModel.from_pretrained(\"huawei-noah/TinyBERT_4L_zh\")\n","        self.pre_classifier = torch.nn.Linear(312, 312)\n","        self.dropout = torch.nn.Dropout(0)\n","        self.classifier = torch.nn.Linear(312, 4)\n","    def forward(self, input_ids, attention_mask, token_type_ids):\n","        output_1 = self.l1(input_ids=input_ids, attention_mask=attention_mask, token_type_ids=token_type_ids)\n","        pooled_output = output_1[1]\n","        pooled_output = self.dropout(pooled_output)\n","        output = self.classifier(pooled_output)\n","        return output"],"execution_count":10,"outputs":[]},{"cell_type":"code","metadata":{"id":"7oIJKucvNRPN","executionInfo":{"status":"ok","timestamp":1606358892140,"user_tz":300,"elapsed":438,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}}},"source":["device = 'cuda'"],"execution_count":11,"outputs":[]},{"cell_type":"code","metadata":{"id":"mmDFQzgI-o-X"},"source":["model = TinyBERTClass()\n","model.to(device)"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"R75IGTvAJOvb"},"source":["# **define training process**"]},{"cell_type":"code","metadata":{"id":"ah2evw6XaA9q"},"source":["def train(epoch):\n","    model.train()\n","    for _,data in tqdm(enumerate(training_loader, 0)):\n","        ids = data['ids'].to(device, dtype = torch.long)\n","        mask = data['mask'].to(device, dtype = torch.long)\n","        token_type_ids = data['token_type_ids'].to(device, dtype = torch.long)\n","        targets = data['targets'].to(device, dtype = torch.float)\n","\n","        outputs = model(ids, mask, token_type_ids)\n","\n","        optimizer.zero_grad()\n","        loss = loss_fn(outputs, targets)\n","        if _%100==0:\n","            print(f'Epoch: {epoch}, Loss:  {loss.item()}')\n","        \n","        optimizer.zero_grad()\n","        loss.backward()\n","        optimizer.step()"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"hTFBrzvPi1rM"},"source":["def loss_fn(outputs, targets):\n","    return torch.nn.BCEWithLogitsLoss()(outputs, targets)\n","optimizer = torch.optim.Adam(params = model.parameters(), lr=LEARNING_RATE)"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"n83_gus2BTXe"},"source":["# **train**"]},{"cell_type":"code","metadata":{"id":"5khMivwk-1GB","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1606255791519,"user_tz":300,"elapsed":472486,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"96364afa-eac2-489a-d2e6-f0778c35b9cc"},"source":["for epoch in range(EPOCHS):\n","    train(epoch)\n","    output_model_file = f'/content/drive/My Drive/Tinybert_emotions_detection_state_dict_11_24_epoch{epoch}.bin'\n","    torch.save(model.state_dict(), output_model_file)"],"execution_count":null,"outputs":[{"output_type":"stream","text":["2it [00:00, 16.83it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.751253604888916\n"],"name":"stdout"},{"output_type":"stream","text":["103it [00:04, 21.97it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.4769855737686157\n"],"name":"stdout"},{"output_type":"stream","text":["202it [00:09, 21.35it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.42059892416000366\n"],"name":"stdout"},{"output_type":"stream","text":["304it [00:14, 21.88it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.3848413825035095\n"],"name":"stdout"},{"output_type":"stream","text":["403it [00:18, 21.31it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.38539832830429077\n"],"name":"stdout"},{"output_type":"stream","text":["504it [00:23, 19.79it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.2784165143966675\n"],"name":"stdout"},{"output_type":"stream","text":["605it [00:28, 22.27it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.24549828469753265\n"],"name":"stdout"},{"output_type":"stream","text":["705it [00:33, 20.97it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.17974549531936646\n"],"name":"stdout"},{"output_type":"stream","text":["804it [00:37, 21.53it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.31541305780410767\n"],"name":"stdout"},{"output_type":"stream","text":["903it [00:42, 22.27it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.18185709416866302\n"],"name":"stdout"},{"output_type":"stream","text":["1002it [00:46, 22.13it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.13315331935882568\n"],"name":"stdout"},{"output_type":"stream","text":["1104it [00:51, 21.17it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.12101586163043976\n"],"name":"stdout"},{"output_type":"stream","text":["1203it [00:55, 22.00it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.15258027613162994\n"],"name":"stdout"},{"output_type":"stream","text":["1305it [01:00, 22.11it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.08170296251773834\n"],"name":"stdout"},{"output_type":"stream","text":["1404it [01:05, 19.13it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.18841342628002167\n"],"name":"stdout"},{"output_type":"stream","text":["1503it [01:09, 22.01it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.12806779146194458\n"],"name":"stdout"},{"output_type":"stream","text":["1604it [01:14, 21.58it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.18476742506027222\n"],"name":"stdout"},{"output_type":"stream","text":["1703it [01:19, 21.18it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.2055925875902176\n"],"name":"stdout"},{"output_type":"stream","text":["1803it [01:23, 19.52it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.27291804552078247\n"],"name":"stdout"},{"output_type":"stream","text":["1905it [01:28, 21.99it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.18251419067382812\n"],"name":"stdout"},{"output_type":"stream","text":["2004it [01:33, 21.98it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.14770367741584778\n"],"name":"stdout"},{"output_type":"stream","text":["2103it [01:37, 22.06it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.1320173740386963\n"],"name":"stdout"},{"output_type":"stream","text":["2202it [01:42, 21.06it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.16657303273677826\n"],"name":"stdout"},{"output_type":"stream","text":["2304it [01:47, 21.52it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.16272011399269104\n"],"name":"stdout"},{"output_type":"stream","text":["2403it [01:51, 22.16it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.11740149557590485\n"],"name":"stdout"},{"output_type":"stream","text":["2505it [01:56, 21.93it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.1214042529463768\n"],"name":"stdout"},{"output_type":"stream","text":["2604it [02:01, 22.16it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.18754905462265015\n"],"name":"stdout"},{"output_type":"stream","text":["2703it [02:05, 22.16it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.25040626525878906\n"],"name":"stdout"},{"output_type":"stream","text":["2804it [02:10, 22.23it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.16067412495613098\n"],"name":"stdout"},{"output_type":"stream","text":["2903it [02:15, 21.99it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.12776565551757812\n"],"name":"stdout"},{"output_type":"stream","text":["3005it [02:19, 22.30it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.07037576287984848\n"],"name":"stdout"},{"output_type":"stream","text":["3104it [02:24, 22.00it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.09690317511558533\n"],"name":"stdout"},{"output_type":"stream","text":["3203it [02:29, 21.32it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.1495223194360733\n"],"name":"stdout"},{"output_type":"stream","text":["3302it [02:33, 21.18it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.1757926344871521\n"],"name":"stdout"},{"output_type":"stream","text":["3405it [02:38, 21.92it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.09993644058704376\n"],"name":"stdout"},{"output_type":"stream","text":["3504it [02:43, 21.77it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.15374641120433807\n"],"name":"stdout"},{"output_type":"stream","text":["3603it [02:47, 22.00it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.15391400456428528\n"],"name":"stdout"},{"output_type":"stream","text":["3702it [02:52, 21.94it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.15132905542850494\n"],"name":"stdout"},{"output_type":"stream","text":["3802it [02:57, 22.13it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.17156371474266052\n"],"name":"stdout"},{"output_type":"stream","text":["3902it [03:01, 20.54it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.16591033339500427\n"],"name":"stdout"},{"output_type":"stream","text":["4004it [03:06, 21.30it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.13162417709827423\n"],"name":"stdout"},{"output_type":"stream","text":["4103it [03:11, 21.99it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.23745284974575043\n"],"name":"stdout"},{"output_type":"stream","text":["4202it [03:15, 21.54it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.1651223748922348\n"],"name":"stdout"},{"output_type":"stream","text":["4304it [03:20, 21.46it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.10341949015855789\n"],"name":"stdout"},{"output_type":"stream","text":["4403it [03:25, 21.93it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.10611237585544586\n"],"name":"stdout"},{"output_type":"stream","text":["4502it [03:29, 22.15it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.09798865020275116\n"],"name":"stdout"},{"output_type":"stream","text":["4604it [03:34, 21.22it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.12044443190097809\n"],"name":"stdout"},{"output_type":"stream","text":["4703it [03:38, 22.11it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.18075647950172424\n"],"name":"stdout"},{"output_type":"stream","text":["4803it [03:43, 21.36it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.10566722601652145\n"],"name":"stdout"},{"output_type":"stream","text":["4905it [03:48, 21.64it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.18034642934799194\n"],"name":"stdout"},{"output_type":"stream","text":["5004it [03:53, 22.02it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.20300015807151794\n"],"name":"stdout"},{"output_type":"stream","text":["5103it [03:57, 22.18it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.1933174729347229\n"],"name":"stdout"},{"output_type":"stream","text":["5203it [04:02, 19.16it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.14222556352615356\n"],"name":"stdout"},{"output_type":"stream","text":["5302it [04:07, 22.07it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.15455493330955505\n"],"name":"stdout"},{"output_type":"stream","text":["5405it [04:11, 22.21it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.12465769797563553\n"],"name":"stdout"},{"output_type":"stream","text":["5503it [04:16, 20.09it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.09481310099363327\n"],"name":"stdout"},{"output_type":"stream","text":["5604it [04:21, 18.40it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.06631606817245483\n"],"name":"stdout"},{"output_type":"stream","text":["5703it [04:26, 19.96it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.12342207133769989\n"],"name":"stdout"},{"output_type":"stream","text":["5805it [04:31, 21.79it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.09232260286808014\n"],"name":"stdout"},{"output_type":"stream","text":["5904it [04:35, 21.05it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.09559513628482819\n"],"name":"stdout"},{"output_type":"stream","text":["6004it [04:40, 21.60it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.0811881348490715\n"],"name":"stdout"},{"output_type":"stream","text":["6103it [04:45, 20.57it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.08941198885440826\n"],"name":"stdout"},{"output_type":"stream","text":["6205it [04:50, 21.12it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.14214767515659332\n"],"name":"stdout"},{"output_type":"stream","text":["6304it [04:54, 21.36it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.1713838130235672\n"],"name":"stdout"},{"output_type":"stream","text":["6403it [04:59, 21.66it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.16274899244308472\n"],"name":"stdout"},{"output_type":"stream","text":["6502it [05:03, 22.27it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.1923961341381073\n"],"name":"stdout"},{"output_type":"stream","text":["6604it [05:08, 21.69it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.107209213078022\n"],"name":"stdout"},{"output_type":"stream","text":["6703it [05:13, 22.12it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.14729377627372742\n"],"name":"stdout"},{"output_type":"stream","text":["6802it [05:17, 20.01it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.12274090945720673\n"],"name":"stdout"},{"output_type":"stream","text":["6903it [05:22, 19.28it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.1263716220855713\n"],"name":"stdout"},{"output_type":"stream","text":["7005it [05:27, 21.42it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.11882403492927551\n"],"name":"stdout"},{"output_type":"stream","text":["7104it [05:32, 21.91it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.15517881512641907\n"],"name":"stdout"},{"output_type":"stream","text":["7204it [05:36, 20.11it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.0937063917517662\n"],"name":"stdout"},{"output_type":"stream","text":["7303it [05:41, 21.51it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.10996507108211517\n"],"name":"stdout"},{"output_type":"stream","text":["7402it [05:46, 21.54it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.18569202721118927\n"],"name":"stdout"},{"output_type":"stream","text":["7504it [05:50, 21.30it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.07555729150772095\n"],"name":"stdout"},{"output_type":"stream","text":["7603it [05:55, 21.70it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.30738139152526855\n"],"name":"stdout"},{"output_type":"stream","text":["7702it [06:00, 21.59it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.120754674077034\n"],"name":"stdout"},{"output_type":"stream","text":["7803it [06:05, 20.34it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.22142380475997925\n"],"name":"stdout"},{"output_type":"stream","text":["7902it [06:09, 21.61it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.1011759489774704\n"],"name":"stdout"},{"output_type":"stream","text":["8004it [06:14, 21.61it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.12389317154884338\n"],"name":"stdout"},{"output_type":"stream","text":["8104it [06:19, 21.31it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.05915609002113342\n"],"name":"stdout"},{"output_type":"stream","text":["8203it [06:23, 19.82it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.051046982407569885\n"],"name":"stdout"},{"output_type":"stream","text":["8302it [06:28, 22.02it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.11195366084575653\n"],"name":"stdout"},{"output_type":"stream","text":["8403it [06:33, 20.12it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.07507720589637756\n"],"name":"stdout"},{"output_type":"stream","text":["8502it [06:37, 21.93it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.13325873017311096\n"],"name":"stdout"},{"output_type":"stream","text":["8604it [06:42, 22.03it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.10387197136878967\n"],"name":"stdout"},{"output_type":"stream","text":["8702it [06:47, 21.22it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.1738814413547516\n"],"name":"stdout"},{"output_type":"stream","text":["8803it [06:52, 19.38it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.14338871836662292\n"],"name":"stdout"},{"output_type":"stream","text":["8904it [06:56, 21.38it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.10867926478385925\n"],"name":"stdout"},{"output_type":"stream","text":["9003it [07:01, 21.47it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.04833701252937317\n"],"name":"stdout"},{"output_type":"stream","text":["9102it [07:05, 21.43it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.08617696166038513\n"],"name":"stdout"},{"output_type":"stream","text":["9204it [07:10, 21.73it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.14772990345954895\n"],"name":"stdout"},{"output_type":"stream","text":["9303it [07:15, 21.72it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.06917181611061096\n"],"name":"stdout"},{"output_type":"stream","text":["9405it [07:19, 22.53it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.16347189247608185\n"],"name":"stdout"},{"output_type":"stream","text":["9504it [07:24, 21.95it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.0868227481842041\n"],"name":"stdout"},{"output_type":"stream","text":["9603it [07:29, 21.85it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.11495481431484222\n"],"name":"stdout"},{"output_type":"stream","text":["9705it [07:33, 21.95it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.11699509620666504\n"],"name":"stdout"},{"output_type":"stream","text":["9803it [07:38, 21.44it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.05927326902747154\n"],"name":"stdout"},{"output_type":"stream","text":["9902it [07:43, 21.64it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.11811941862106323\n"],"name":"stdout"},{"output_type":"stream","text":["10004it [07:47, 19.87it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 0, Loss:  0.04960891976952553\n"],"name":"stdout"},{"output_type":"stream","text":["10075it [07:51, 21.38it/s]\n"],"name":"stderr"}]},{"cell_type":"markdown","metadata":{"id":"p9LNZ0wxzYFu"},"source":["# **Evaluation on isear dataset**"]},{"cell_type":"code","metadata":{"id":"HZnFLjfET_td","executionInfo":{"status":"ok","timestamp":1606358883211,"user_tz":300,"elapsed":2579,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}}},"source":["df = pd.read_csv('/content/drive/My Drive/isear_processed_emotions.csv')\n","df = pd.get_dummies(df, columns=['emotions'])\n","df['labels'] = df[['emotions_anger', 'emotions_fear', 'emotions_joy', 'emotions_sadness']].values.astype('int').tolist()\n","df = df[(df['emotions_anger']==1) | (df['emotions_fear']==1) | (df['emotions_joy']==1) | (df['emotions_sadness']==1)]"],"execution_count":4,"outputs":[]},{"cell_type":"code","metadata":{"id":"DUdILd6czvwB","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1606358889578,"user_tz":300,"elapsed":8937,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"199b999b-93f9-45d0-d7e9-0cf1512f37ee"},"source":["!pip install contractions"],"execution_count":5,"outputs":[{"output_type":"stream","text":["Collecting contractions\n","  Downloading https://files.pythonhosted.org/packages/00/92/a05b76a692ac08d470ae5c23873cf1c9a041532f1ee065e74b374f218306/contractions-0.0.25-py2.py3-none-any.whl\n","Collecting textsearch\n","  Downloading https://files.pythonhosted.org/packages/42/a8/03407021f9555043de5492a2bd7a35c56cc03c2510092b5ec018cae1bbf1/textsearch-0.0.17-py2.py3-none-any.whl\n","Collecting pyahocorasick\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/f4/9f/f0d8e8850e12829eea2e778f1c90e3c53a9a799b7f412082a5d21cd19ae1/pyahocorasick-1.4.0.tar.gz (312kB)\n","\u001b[K     |████████████████████████████████| 317kB 14.6MB/s \n","\u001b[?25hCollecting Unidecode\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/d0/42/d9edfed04228bacea2d824904cae367ee9efd05e6cce7ceaaedd0b0ad964/Unidecode-1.1.1-py2.py3-none-any.whl (238kB)\n","\u001b[K     |████████████████████████████████| 245kB 25.0MB/s \n","\u001b[?25hBuilding wheels for collected packages: pyahocorasick\n","  Building wheel for pyahocorasick (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for pyahocorasick: filename=pyahocorasick-1.4.0-cp36-cp36m-linux_x86_64.whl size=81698 sha256=2664498c9c878d49f02adb3d81f12630db7ef9ffee56dc3ed1b17e6ac9a7a47f\n","  Stored in directory: /root/.cache/pip/wheels/0a/90/61/87a55f5b459792fbb2b7ba6b31721b06ff5cf6bde541b40994\n","Successfully built pyahocorasick\n","Installing collected packages: pyahocorasick, Unidecode, textsearch, contractions\n","Successfully installed Unidecode-1.1.1 contractions-0.0.25 pyahocorasick-1.4.0 textsearch-0.0.17\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"_kvznu7CzxUu","executionInfo":{"status":"ok","timestamp":1606358889579,"user_tz":300,"elapsed":8456,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}}},"source":["import re\n","import contractions\n","import unicodedata\n","import string"],"execution_count":6,"outputs":[]},{"cell_type":"code","metadata":{"id":"izhYJBdbzzJS","executionInfo":{"status":"ok","timestamp":1606358889580,"user_tz":300,"elapsed":8050,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}}},"source":["def clean_text(text):\n","    \"\"\"\n","    Function to clean text with basic steps - lower casing, dealing with contractions, remove html codes,\n","    strip whitespaces, social media cleaning (remove hashtags and URLS), remove punctuationns, using regular expressions.\n"," \n","    Parameters\n","    ----------\n","    text : str\n","            Text to be cleaned\n","    \n","    Returns\n","    -------\n","    text : str\n","            Cleaned text\n","    \"\"\"\n","    # Lower casing\n","    text = text.lower()\n","    \n","    \n","    # Remove html codes\n","    text = re.sub(r\"&amp;\", \" \", text)\n","    text = re.sub(r\"&quot;\", \" \", text)\n","    text = re.sub(r\"&#39;\", \" \", text)\n","    text = re.sub(r\"&gt;\", \" \", text)\n","    text = re.sub(r\"&lt;\", \" \", text)\n","    \n","    # Strips (removes) whitespaces\n","    text = text.strip(' ')\n","    \n","    ################ Social media cleaning ############\n","    \n","    # Remove hashtags (Regex @[A-Za-z0-9]+ represents mentions and #[A-Za-z0-9]+ represents hashtags. )\n","    text = re.sub(\"(@[A-Za-z0-9]+)|(#[A-Za-z0-9]+)\", \" \", text)\n","    \n","    # Remove URLS (Regex \\w+:\\/\\/\\S+ matches all the URLs starting with http:// or https:// and replacing it with space.)\n","    text = re.sub(\"(\\w+:\\/\\/\\S+)\", \" \", text)\n","    text = re.sub(r'http\\S+', ' ', text)\n","    \n","     # remove old style retweet text \"RT\"\n","    text = re.sub(r'^RT[\\s]+', '', text)\n","    # remove accents\n","    text = unicodedata.normalize('NFKD', text).encode('ascii', 'ignore').decode('utf-8', 'ignore')\n","    # remove @users\n","    text = re.sub(r'@[\\w]*', '', text)\n","    # remove Reddit channel reference /r\n","    text = re.sub(r'r/', '', text)\n","    \n","    # remove reddit username\n","    text = re.sub(r'u/[\\w]*', '', text)\n","    # remove '&gt;' like notations\n","    text = re.sub('&\\W*\\w*\\W*;', ' ', text)\n","    # remove hashtags\n","    text = re.sub(r'#[\\w]*', '', text)\n","    ###################################################\n","    \n","    # Dealing with contractions\n","    text = contractions.fix(text)\n","    \n","    text = re.sub(r\"what\\'s\", \"what is \", text)\n","    text = re.sub(r\"\\'s\", \" \", text)\n","    text = re.sub(r\"\\'ve\", \" have \", text)\n","    text = re.sub(r\"can\\'t\", \"can not \", text)\n","    text = re.sub(r\"n\\'t\", \" not \", text)\n","    text = re.sub(r\"\\'t\", \" not\", text )\n","    text = re.sub(r\"i\\'m\", \"i am \", text)\n","    text = re.sub(r\"\\'em'\", \" them \", text)\n","    text = re.sub(r\"\\'re\", \" are \", text)\n","    text = re.sub(r\"\\'d\", \" would \", text)\n","    text = re.sub(r\"\\'ll\", \" will \", text)\n","    text = re.sub(r\"\\'scuse\", \" excuse \", text)\n","    \n","    \n","    # Removes punctuations\n","    text = re.sub('['+string.punctuation+']', \" \", text)\n","    \n","\t# Removes non alphanumeric characters\n","    #text = re.sub('\\W', ' ', text)\n","    \n","    # Removes non alphabetical characters\n","    text = re.sub('[^a-zA-Z]+', ' ', text)\n","    \n","    # Replaces all whitespaces by 1 whitespace\n","    text = re.sub('\\s+', ' ', text)\n","    \n","    return text"],"execution_count":7,"outputs":[]},{"cell_type":"code","metadata":{"id":"3B69d5Juz0mG","executionInfo":{"status":"ok","timestamp":1606358889989,"user_tz":300,"elapsed":6217,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}}},"source":["df['text'] = df['text'].apply(clean_text)"],"execution_count":8,"outputs":[]},{"cell_type":"code","metadata":{"id":"WM1k8LOzE_TE","executionInfo":{"status":"ok","timestamp":1606359007783,"user_tz":300,"elapsed":422,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}}},"source":["device = 'cpu'"],"execution_count":15,"outputs":[]},{"cell_type":"code","metadata":{"id":"PABm-NeqGbcr","executionInfo":{"status":"ok","timestamp":1606359200329,"user_tz":300,"elapsed":1212,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}}},"source":["eval_model = TinyBERTClass()"],"execution_count":29,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"oJkA8CgFFA7o","executionInfo":{"status":"ok","timestamp":1606359201890,"user_tz":300,"elapsed":453,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"869a2195-466f-446a-b918-6e3adc55d765"},"source":["eval_model.load_state_dict(torch.load('/content/drive/MyDrive/Tinybert_huawei_emotions_detection_state_dict_wholeset_11_25_epoch20.bin'), strict=False)"],"execution_count":30,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<All keys matched successfully>"]},"metadata":{"tags":[]},"execution_count":30}]},{"cell_type":"code","metadata":{"id":"98OBFHnWc-F2","executionInfo":{"status":"ok","timestamp":1606359557966,"user_tz":300,"elapsed":464,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}}},"source":["eval_model = torch.quantization.quantize_dynamic(eval_model, {torch.nn.Linear}, dtype=torch.qint8)"],"execution_count":37,"outputs":[]},{"cell_type":"code","metadata":{"id":"BsrkP0Ntz2X2","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1606359655235,"user_tz":300,"elapsed":96182,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"76c884c4-c60f-4432-8c84-c3b7fd097349"},"source":["eval_model.to(device)\n","eval_model.eval()\n","pred = []\n","from tqdm import tqdm\n","for text in tqdm(df.text.values):\n","  input = tokenizer.encode_plus(\n","            text,\n","            None,\n","            add_special_tokens=True,\n","            max_length=MAX_LEN,\n","            pad_to_max_length=True,\n","            return_token_type_ids=True\n","        )\n","  ids = torch.tensor([input['input_ids']], dtype=torch.long)\n","  mask = torch.tensor([input['attention_mask']], dtype=torch.long)\n","  token_type_ids = torch.tensor([input[\"token_type_ids\"]], dtype=torch.long)\n","  # to device\n","  ids = ids.to(device, dtype = torch.long)\n","  mask = mask.to(device, dtype = torch.long)\n","  token_type_ids = token_type_ids.to(device, dtype = torch.long)\n","  output = eval_model(ids, mask, token_type_ids)\n","  pred.append(torch.sigmoid(output).cpu().detach().numpy().tolist())"],"execution_count":38,"outputs":[{"output_type":"stream","text":["100%|██████████| 4381/4381 [01:35<00:00, 45.76it/s]\n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":35},"id":"3mtN0UXkK0Qa","executionInfo":{"status":"ok","timestamp":1606359131190,"user_tz":300,"elapsed":395,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"dde65980-67fc-4dde-92a4-f682cef43f16"},"source":["device"],"execution_count":18,"outputs":[{"output_type":"execute_result","data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"},"text/plain":["'cpu'"]},"metadata":{"tags":[]},"execution_count":18}]},{"cell_type":"code","metadata":{"id":"O-uM4oWg0IEA","executionInfo":{"status":"ok","timestamp":1606359537692,"user_tz":300,"elapsed":475,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}}},"source":["pred_y = np.array(pred)\n","pred_y = pred_y.squeeze(axis=1)\n","for i in range(len(pred_y)):\n","  for j in range(4):\n","    pred_y[i, j] =1 if pred_y[i, j] >= 0.5 else 0\n","pred_y = pred_y.astype('int')\n","\n","real_y = df.labels.values.tolist()\n","real_y = np.array(real_y)\n","real_y = real_y.astype('int')"],"execution_count":32,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"9XjZyzE98ZPI"},"source":["**overall metrics**"]},{"cell_type":"code","metadata":{"id":"molN6Li72ab2","executionInfo":{"status":"ok","timestamp":1606359539332,"user_tz":300,"elapsed":500,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}}},"source":["from sklearn.metrics import f1_score, precision_score, recall_score"],"execution_count":33,"outputs":[]},{"cell_type":"code","metadata":{"id":"CKxv6f3X645Z","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1606359539583,"user_tz":300,"elapsed":277,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"e1e8340d-f839-4af5-b5e3-9bc2fe4f2e36"},"source":["precision_score(real_y, pred_y, average='macro')"],"execution_count":34,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.8634596127144798"]},"metadata":{"tags":[]},"execution_count":34}]},{"cell_type":"code","metadata":{"id":"IZvoT-WP69wr","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1606359542494,"user_tz":300,"elapsed":462,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"e920a572-6126-44cd-9492-78bcee36dc07"},"source":["recall_score(real_y, pred_y, average='macro')"],"execution_count":35,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.7865032722809377"]},"metadata":{"tags":[]},"execution_count":35}]},{"cell_type":"code","metadata":{"id":"_ehHpjqx8S4N","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1606359543529,"user_tz":300,"elapsed":455,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"bcb8f48f-3659-42dc-e396-865b32a9cb58"},"source":["f1_score(real_y, pred_y, average='macro')"],"execution_count":36,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.8136442064943417"]},"metadata":{"tags":[]},"execution_count":36}]},{"cell_type":"markdown","metadata":{"id":"ps-u95488lMp"},"source":["**precision score**"]},{"cell_type":"code","metadata":{"id":"rg8S3uLn8VJv","executionInfo":{"status":"ok","timestamp":1606359143332,"user_tz":300,"elapsed":428,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}}},"source":["precision = [precision_score(real_y[:, 0], pred_y[:, 0]),\n","             precision_score(real_y[:, 1], pred_y[:, 1]),\n","             precision_score(real_y[:, 2], pred_y[:, 2]),\n","             precision_score(real_y[:, 3], pred_y[:, 3]),\n","             precision_score(real_y, pred_y, average='macro'),\n","             precision_score(real_y, pred_y, average='micro'),\n","             precision_score(real_y, pred_y, average='weighted')]"],"execution_count":24,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"7Vah68bH9ANT"},"source":["**recall score**"]},{"cell_type":"code","metadata":{"id":"oczZ_czk8-pR","executionInfo":{"status":"ok","timestamp":1606359145987,"user_tz":300,"elapsed":385,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}}},"source":["recall = [recall_score(real_y[:, 0], pred_y[:, 0]),\n","          recall_score(real_y[:, 1], pred_y[:, 1]),\n","          recall_score(real_y[:, 2], pred_y[:, 2]),\n","          recall_score(real_y[:, 3], pred_y[:, 3]),\n","          recall_score(real_y, pred_y, average='macro'),\n","          recall_score(real_y, pred_y, average='micro'),\n","          recall_score(real_y, pred_y, average='weighted')]"],"execution_count":25,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"2OF0QDTg9LwT"},"source":["**f1 score**"]},{"cell_type":"code","metadata":{"id":"UFmkGPSK9KzJ","executionInfo":{"status":"ok","timestamp":1606359147722,"user_tz":300,"elapsed":395,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}}},"source":["f1 = [f1_score(real_y[:, 0], pred_y[:, 0]),\n","      f1_score(real_y[:, 1], pred_y[:, 1]),\n","      f1_score(real_y[:, 2], pred_y[:, 2]),\n","      f1_score(real_y[:, 3], pred_y[:, 3]),\n","      f1_score(real_y, pred_y, average='macro'),\n","      f1_score(real_y, pred_y, average='micro'),\n","      f1_score(real_y, pred_y, average='weighted')]"],"execution_count":26,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"eNVLACLy9ZRY"},"source":["**overall**"]},{"cell_type":"code","metadata":{"id":"LqysRzuI9Yhj","executionInfo":{"status":"ok","timestamp":1606359149673,"user_tz":300,"elapsed":369,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}}},"source":["metric = pd.DataFrame([precision, recall, f1], columns=['anger', 'fear', 'joy', 'sadness', 'macro', 'micro', 'weighted'], index=['precision', 'recall','f1'])"],"execution_count":27,"outputs":[]},{"cell_type":"code","metadata":{"id":"UFJEZpEP9vC-","colab":{"base_uri":"https://localhost:8080/","height":142},"executionInfo":{"status":"ok","timestamp":1606359150571,"user_tz":300,"elapsed":397,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"78ecdaa0-29c9-4bc9-dcad-8f63a68d7b2f"},"source":["metric"],"execution_count":28,"outputs":[{"output_type":"execute_result","data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>anger</th>\n","      <th>fear</th>\n","      <th>joy</th>\n","      <th>sadness</th>\n","      <th>macro</th>\n","      <th>micro</th>\n","      <th>weighted</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>precision</th>\n","      <td>0.792230</td>\n","      <td>0.935622</td>\n","      <td>0.916329</td>\n","      <td>0.773601</td>\n","      <td>0.854446</td>\n","      <td>0.842378</td>\n","      <td>0.854399</td>\n","    </tr>\n","    <tr>\n","      <th>recall</th>\n","      <td>0.855839</td>\n","      <td>0.796347</td>\n","      <td>0.620658</td>\n","      <td>0.844891</td>\n","      <td>0.779434</td>\n","      <td>0.779502</td>\n","      <td>0.779502</td>\n","    </tr>\n","    <tr>\n","      <th>f1</th>\n","      <td>0.822807</td>\n","      <td>0.860385</td>\n","      <td>0.740054</td>\n","      <td>0.807676</td>\n","      <td>0.807730</td>\n","      <td>0.809721</td>\n","      <td>0.807749</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["              anger      fear       joy   sadness     macro     micro  weighted\n","precision  0.792230  0.935622  0.916329  0.773601  0.854446  0.842378  0.854399\n","recall     0.855839  0.796347  0.620658  0.844891  0.779434  0.779502  0.779502\n","f1         0.822807  0.860385  0.740054  0.807676  0.807730  0.809721  0.807749"]},"metadata":{"tags":[]},"execution_count":28}]},{"cell_type":"markdown","metadata":{"id":"rkWOpHjWASll"},"source":["# **evaluate on goemotion test dataset**"]},{"cell_type":"code","metadata":{"id":"AfWS49_gAQZp"},"source":["data = pd.read_csv('/content/drive/My Drive/goemotions_aug_dairai_test_cleaned.csv')\n","data.drop(['Unnamed: 0', 'datasource'], inplace=True, axis=1)\n","df = pd.DataFrame()\n","df['text'] = data['cleaned_processed']\n","df['labels'] = data[['anger', 'fear', 'joy', 'sadness']].values.astype('int').tolist()"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":132,"referenced_widgets":["1d9525281e214dfeb19eabd723467a8a","ba7b929725244ff9823526986bad7279","17ae39d946904734a7774f00bfaad12b","d266b23198194eb88e6ae251fc1ebf17","0f55921f5268488082e25b1d57264d47","a977fddbba814c2d9e608c1097c8f4c5","ceeddd48b6b4405bb8e6914f8301bd06","39a76ec139774e85b1fabc084e3bc748","1331333cda9c4b97bd3de4ec193cc005","c1ed4e8b063a41319c448cb9f7af4bc8","9f21d8b71c564c18b91a72081c605de1","f86fd085242d4880ae5c8ef0b76c4f0d","7bd3fcd870ef4b9dae0ed1d46eb66e4b","a589983ad7bc4354892e0193bf4534ee","06267a26e37542e3b1b2aa9f491896ab","03c88c3c1283439899ba967956610756"]},"id":"IOSDSGXvAkrp","executionInfo":{"status":"ok","timestamp":1606318407403,"user_tz":300,"elapsed":46971,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"e8cc8820-ef06-4d70-c691-1ab83c984738"},"source":["eval_model = TinyBERTClass()\n","eval_model.load_state_dict(torch.load('/content/drive/MyDrive/Tinybert_emotions_detection_state_dict_wholeset_11_24_epoch20.bin'), strict=False)"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"1d9525281e214dfeb19eabd723467a8a","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=475.0, style=ProgressStyle(description_…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"1331333cda9c4b97bd3de4ec193cc005","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=59499772.0, style=ProgressStyle(descrip…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"execute_result","data":{"text/plain":["<All keys matched successfully>"]},"metadata":{"tags":[]},"execution_count":7}]},{"cell_type":"code","metadata":{"id":"6IS27GoMAu1c"},"source":["device = 'cuda'"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ciQenyckAwNj","executionInfo":{"status":"ok","timestamp":1606339690438,"user_tz":300,"elapsed":267051,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"4b7aafc1-aa50-4f1c-8e67-2adfc4af46eb"},"source":["eval_model.to(device)\n","eval_model.eval()\n","pred = []\n","from tqdm import tqdm\n","for text in tqdm(df.text.values):\n","  input = tokenizer.encode_plus(\n","            text,\n","            None,\n","            add_special_tokens=True,\n","            max_length=MAX_LEN,\n","            pad_to_max_length=True,\n","            return_token_type_ids=True\n","        )\n","  ids = torch.tensor([input['input_ids']], dtype=torch.long)\n","  mask = torch.tensor([input['attention_mask']], dtype=torch.long)\n","  token_type_ids = torch.tensor([input[\"token_type_ids\"]], dtype=torch.long)\n","  # to device\n","  ids = ids.to(device, dtype = torch.long)\n","  mask = mask.to(device, dtype = torch.long)\n","  token_type_ids = token_type_ids.to(device, dtype = torch.long)\n","  output = eval_model(ids, mask, token_type_ids)\n","  pred.append(torch.sigmoid(output).cpu().detach().numpy().tolist())\n","  "],"execution_count":null,"outputs":[{"output_type":"stream","text":["100%|██████████| 42979/42979 [04:26<00:00, 161.30it/s]\n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"LlEUC0QaEJH4"},"source":["pred_y = np.array(pred)\n","pred_y = pred_y.squeeze(axis=1)\n","for i in range(len(pred_y)):\n","  for j in range(4):\n","    pred_y[i, j] =1 if pred_y[i, j] >= 0.5 else 0\n","pred_y = pred_y.astype('int')\n","\n","real_y = df.labels.values.tolist()\n","real_y = np.array(real_y)\n","real_y = real_y.astype('int')"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"kl8gWR7aETtT"},"source":["from sklearn.metrics import f1_score, precision_score, recall_score"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"2VZaoQ8iEQqZ"},"source":["precision = [precision_score(real_y[:, 0], pred_y[:, 0]),\n","             precision_score(real_y[:, 1], pred_y[:, 1]),\n","             precision_score(real_y[:, 2], pred_y[:, 2]),\n","             precision_score(real_y[:, 3], pred_y[:, 3]),\n","             precision_score(real_y, pred_y, average='macro'),\n","             precision_score(real_y, pred_y, average='micro'),\n","             precision_score(real_y, pred_y, average='weighted')]"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"wSN2ztY1EWYI"},"source":["recall = [recall_score(real_y[:, 0], pred_y[:, 0]),\n","          recall_score(real_y[:, 1], pred_y[:, 1]),\n","          recall_score(real_y[:, 2], pred_y[:, 2]),\n","          recall_score(real_y[:, 3], pred_y[:, 3]),\n","          recall_score(real_y, pred_y, average='macro'),\n","          recall_score(real_y, pred_y, average='micro'),\n","          recall_score(real_y, pred_y, average='weighted')]"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"o4GwNTxSEYhi"},"source":["f1 = [f1_score(real_y[:, 0], pred_y[:, 0]),\n","      f1_score(real_y[:, 1], pred_y[:, 1]),\n","      f1_score(real_y[:, 2], pred_y[:, 2]),\n","      f1_score(real_y[:, 3], pred_y[:, 3]),\n","      f1_score(real_y, pred_y, average='macro'),\n","      f1_score(real_y, pred_y, average='micro'),\n","      f1_score(real_y, pred_y, average='weighted')]"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"j3ru7OOkEb1K"},"source":["metric = pd.DataFrame([precision, recall, f1], columns=['anger', 'fear', 'joy', 'sadness', 'macro', 'micro', 'weighted'], index=['precision', 'recall','f1'])"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":142},"id":"xDBJr5J7EcpC","executionInfo":{"status":"ok","timestamp":1606339711172,"user_tz":300,"elapsed":384,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"f616c3c0-00a3-406e-da9c-cef22abde861"},"source":["metric"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>anger</th>\n","      <th>fear</th>\n","      <th>joy</th>\n","      <th>sadness</th>\n","      <th>macro</th>\n","      <th>micro</th>\n","      <th>weighted</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>precision</th>\n","      <td>0.937691</td>\n","      <td>0.983797</td>\n","      <td>0.816284</td>\n","      <td>0.978732</td>\n","      <td>0.929126</td>\n","      <td>0.912641</td>\n","      <td>0.914681</td>\n","    </tr>\n","    <tr>\n","      <th>recall</th>\n","      <td>0.927768</td>\n","      <td>0.981647</td>\n","      <td>0.866135</td>\n","      <td>0.983714</td>\n","      <td>0.939816</td>\n","      <td>0.932081</td>\n","      <td>0.932081</td>\n","    </tr>\n","    <tr>\n","      <th>f1</th>\n","      <td>0.932703</td>\n","      <td>0.982721</td>\n","      <td>0.840471</td>\n","      <td>0.981217</td>\n","      <td>0.934278</td>\n","      <td>0.922259</td>\n","      <td>0.923112</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["              anger      fear       joy   sadness     macro     micro  weighted\n","precision  0.937691  0.983797  0.816284  0.978732  0.929126  0.912641  0.914681\n","recall     0.927768  0.981647  0.866135  0.983714  0.939816  0.932081  0.932081\n","f1         0.932703  0.982721  0.840471  0.981217  0.934278  0.922259  0.923112"]},"metadata":{"tags":[]},"execution_count":125}]},{"cell_type":"markdown","metadata":{"id":"Q8K8xa7PnvCR"},"source":["# **seems good and train on the whole data set**"]},{"cell_type":"code","metadata":{"id":"a96TtM8Zn3Uy"},"source":["whole_data=new_df.sample(frac=1)\n","whole_set = MultiLabelDataset(whole_data, tokenizer, MAX_LEN)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"Q3ZUALsAoPLP"},"source":["train_params = {'batch_size': TRAIN_BATCH_SIZE,\n","                'shuffle': True,\n","                'num_workers': 0\n","                }\n","\n","training_loader = DataLoader(whole_set, **train_params)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"M0uj5JdNo3Rj"},"source":["device = 'cuda'"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"DcyxSJn0UwtX","executionInfo":{"status":"ok","timestamp":1606323301385,"user_tz":300,"elapsed":10691,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"bb02f5e0-6dbd-4e33-fb0f-3809b58c4c2a"},"source":["model = TinyBERTClass()\n","model.to(device)"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["TinyBERTClass(\n","  (l1): BertModel(\n","    (embeddings): BertEmbeddings(\n","      (word_embeddings): Embedding(21128, 312, padding_idx=0)\n","      (position_embeddings): Embedding(512, 312)\n","      (token_type_embeddings): Embedding(2, 312)\n","      (LayerNorm): LayerNorm((312,), eps=1e-12, elementwise_affine=True)\n","      (dropout): Dropout(p=0.1, inplace=False)\n","    )\n","    (encoder): BertEncoder(\n","      (layer): ModuleList(\n","        (0): BertLayer(\n","          (attention): BertAttention(\n","            (self): BertSelfAttention(\n","              (query): Linear(in_features=312, out_features=312, bias=True)\n","              (key): Linear(in_features=312, out_features=312, bias=True)\n","              (value): Linear(in_features=312, out_features=312, bias=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","            (output): BertSelfOutput(\n","              (dense): Linear(in_features=312, out_features=312, bias=True)\n","              (LayerNorm): LayerNorm((312,), eps=1e-12, elementwise_affine=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","          )\n","          (intermediate): BertIntermediate(\n","            (dense): Linear(in_features=312, out_features=1200, bias=True)\n","          )\n","          (output): BertOutput(\n","            (dense): Linear(in_features=1200, out_features=312, bias=True)\n","            (LayerNorm): LayerNorm((312,), eps=1e-12, elementwise_affine=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","        )\n","        (1): BertLayer(\n","          (attention): BertAttention(\n","            (self): BertSelfAttention(\n","              (query): Linear(in_features=312, out_features=312, bias=True)\n","              (key): Linear(in_features=312, out_features=312, bias=True)\n","              (value): Linear(in_features=312, out_features=312, bias=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","            (output): BertSelfOutput(\n","              (dense): Linear(in_features=312, out_features=312, bias=True)\n","              (LayerNorm): LayerNorm((312,), eps=1e-12, elementwise_affine=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","          )\n","          (intermediate): BertIntermediate(\n","            (dense): Linear(in_features=312, out_features=1200, bias=True)\n","          )\n","          (output): BertOutput(\n","            (dense): Linear(in_features=1200, out_features=312, bias=True)\n","            (LayerNorm): LayerNorm((312,), eps=1e-12, elementwise_affine=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","        )\n","        (2): BertLayer(\n","          (attention): BertAttention(\n","            (self): BertSelfAttention(\n","              (query): Linear(in_features=312, out_features=312, bias=True)\n","              (key): Linear(in_features=312, out_features=312, bias=True)\n","              (value): Linear(in_features=312, out_features=312, bias=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","            (output): BertSelfOutput(\n","              (dense): Linear(in_features=312, out_features=312, bias=True)\n","              (LayerNorm): LayerNorm((312,), eps=1e-12, elementwise_affine=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","          )\n","          (intermediate): BertIntermediate(\n","            (dense): Linear(in_features=312, out_features=1200, bias=True)\n","          )\n","          (output): BertOutput(\n","            (dense): Linear(in_features=1200, out_features=312, bias=True)\n","            (LayerNorm): LayerNorm((312,), eps=1e-12, elementwise_affine=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","        )\n","        (3): BertLayer(\n","          (attention): BertAttention(\n","            (self): BertSelfAttention(\n","              (query): Linear(in_features=312, out_features=312, bias=True)\n","              (key): Linear(in_features=312, out_features=312, bias=True)\n","              (value): Linear(in_features=312, out_features=312, bias=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","            (output): BertSelfOutput(\n","              (dense): Linear(in_features=312, out_features=312, bias=True)\n","              (LayerNorm): LayerNorm((312,), eps=1e-12, elementwise_affine=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","          )\n","          (intermediate): BertIntermediate(\n","            (dense): Linear(in_features=312, out_features=1200, bias=True)\n","          )\n","          (output): BertOutput(\n","            (dense): Linear(in_features=1200, out_features=312, bias=True)\n","            (LayerNorm): LayerNorm((312,), eps=1e-12, elementwise_affine=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","        )\n","      )\n","    )\n","    (pooler): BertPooler(\n","      (dense): Linear(in_features=312, out_features=312, bias=True)\n","      (activation): Tanh()\n","    )\n","  )\n","  (pre_classifier): Linear(in_features=312, out_features=312, bias=True)\n","  (dropout): Dropout(p=0, inplace=False)\n","  (classifier): Linear(in_features=312, out_features=4, bias=True)\n",")"]},"metadata":{"tags":[]},"execution_count":16}]},{"cell_type":"code","metadata":{"id":"RrlJHFOyoZOJ"},"source":["def train(epoch):\n","    model.train()\n","    for _,data in tqdm(enumerate(training_loader, 0)):\n","        ids = data['ids'].to(device, dtype = torch.long)\n","        mask = data['mask'].to(device, dtype = torch.long)\n","        token_type_ids = data['token_type_ids'].to(device, dtype = torch.long)\n","        targets = data['targets'].to(device, dtype = torch.float)\n","\n","        outputs = model(ids, mask, token_type_ids)\n","\n","        optimizer.zero_grad()\n","        loss = loss_fn(outputs, targets)\n","        if _%100==0:\n","            print(f'Epoch: {epoch}, Loss:  {loss.item()}')\n","        \n","        optimizer.zero_grad()\n","        loss.backward()\n","        optimizer.step()"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"MMoiStZBojp-"},"source":["def loss_fn(outputs, targets):\n","    return torch.nn.BCEWithLogitsLoss()(outputs, targets)\n","# after 15 epochs, set lr to 3e-5\n","LEARNING_RATE = 3e-5\n","optimizer = torch.optim.AdamW(params = model.parameters(), lr=LEARNING_RATE)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"mH2T3pDfotwf","executionInfo":{"status":"ok","timestamp":1606339267199,"user_tz":300,"elapsed":2187863,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"d160b7aa-ccaa-46d8-d1ca-3a03b49b2ad3"},"source":["for epoch in range(3):\n","    train(epoch+18)\n","    output_model_file = f'/content/drive/My Drive/Tinybert_huawei_emotions_detection_state_dict_wholeset_11_25_epoch{epoch+18}.bin'\n","    torch.save(model.state_dict(), output_model_file)"],"execution_count":null,"outputs":[{"output_type":"stream","text":["4it [00:00, 14.55it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.02343745157122612\n"],"name":"stdout"},{"output_type":"stream","text":["102it [00:05, 20.11it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.005792865063995123\n"],"name":"stdout"},{"output_type":"stream","text":["203it [00:10, 20.40it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.010240217670798302\n"],"name":"stdout"},{"output_type":"stream","text":["304it [00:15, 19.60it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.04288150370121002\n"],"name":"stdout"},{"output_type":"stream","text":["402it [00:20, 19.82it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.035814739763736725\n"],"name":"stdout"},{"output_type":"stream","text":["503it [00:25, 19.12it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.006614041514694691\n"],"name":"stdout"},{"output_type":"stream","text":["604it [00:30, 19.33it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.03609810769557953\n"],"name":"stdout"},{"output_type":"stream","text":["703it [00:35, 19.51it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.026301434263586998\n"],"name":"stdout"},{"output_type":"stream","text":["802it [00:40, 19.63it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.02516324073076248\n"],"name":"stdout"},{"output_type":"stream","text":["904it [00:45, 20.28it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.023784089833498\n"],"name":"stdout"},{"output_type":"stream","text":["1003it [00:50, 19.31it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.02412322163581848\n"],"name":"stdout"},{"output_type":"stream","text":["1103it [00:56, 18.88it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.010871450416743755\n"],"name":"stdout"},{"output_type":"stream","text":["1204it [01:01, 19.77it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.04304368793964386\n"],"name":"stdout"},{"output_type":"stream","text":["1303it [01:06, 19.85it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.024218101054430008\n"],"name":"stdout"},{"output_type":"stream","text":["1403it [01:11, 19.99it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.013600979000329971\n"],"name":"stdout"},{"output_type":"stream","text":["1504it [01:16, 19.82it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.01291305385529995\n"],"name":"stdout"},{"output_type":"stream","text":["1604it [01:21, 20.18it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.027916211634874344\n"],"name":"stdout"},{"output_type":"stream","text":["1704it [01:26, 19.85it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.02291000448167324\n"],"name":"stdout"},{"output_type":"stream","text":["1803it [01:31, 19.85it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.050777144730091095\n"],"name":"stdout"},{"output_type":"stream","text":["1902it [01:36, 19.58it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.008766628801822662\n"],"name":"stdout"},{"output_type":"stream","text":["2003it [01:41, 19.50it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.0230955109000206\n"],"name":"stdout"},{"output_type":"stream","text":["2104it [01:46, 20.07it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.010333489626646042\n"],"name":"stdout"},{"output_type":"stream","text":["2203it [01:51, 20.24it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.007057514041662216\n"],"name":"stdout"},{"output_type":"stream","text":["2302it [01:56, 20.09it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.058261722326278687\n"],"name":"stdout"},{"output_type":"stream","text":["2404it [02:01, 19.91it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.01973063498735428\n"],"name":"stdout"},{"output_type":"stream","text":["2504it [02:06, 19.50it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.004981733858585358\n"],"name":"stdout"},{"output_type":"stream","text":["2604it [02:11, 19.70it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.04405969753861427\n"],"name":"stdout"},{"output_type":"stream","text":["2704it [02:16, 19.68it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.02851158194243908\n"],"name":"stdout"},{"output_type":"stream","text":["2803it [02:21, 19.51it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.0195302851498127\n"],"name":"stdout"},{"output_type":"stream","text":["2903it [02:26, 19.55it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.037247929722070694\n"],"name":"stdout"},{"output_type":"stream","text":["3002it [02:31, 20.20it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.016935136169195175\n"],"name":"stdout"},{"output_type":"stream","text":["3104it [02:36, 19.77it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.017857084050774574\n"],"name":"stdout"},{"output_type":"stream","text":["3203it [02:41, 19.86it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.07289525866508484\n"],"name":"stdout"},{"output_type":"stream","text":["3303it [02:46, 20.10it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.05672531574964523\n"],"name":"stdout"},{"output_type":"stream","text":["3404it [02:52, 19.69it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.03014810010790825\n"],"name":"stdout"},{"output_type":"stream","text":["3502it [02:56, 20.02it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.029334768652915955\n"],"name":"stdout"},{"output_type":"stream","text":["3603it [03:02, 19.64it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.03938804194331169\n"],"name":"stdout"},{"output_type":"stream","text":["3703it [03:07, 19.73it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.06245942413806915\n"],"name":"stdout"},{"output_type":"stream","text":["3803it [03:12, 20.23it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.01887786015868187\n"],"name":"stdout"},{"output_type":"stream","text":["3903it [03:17, 19.41it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.007915590889751911\n"],"name":"stdout"},{"output_type":"stream","text":["4004it [03:22, 19.60it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.008277973160147667\n"],"name":"stdout"},{"output_type":"stream","text":["4104it [03:27, 19.33it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.04704936221241951\n"],"name":"stdout"},{"output_type":"stream","text":["4204it [03:32, 20.14it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.019737083464860916\n"],"name":"stdout"},{"output_type":"stream","text":["4303it [03:37, 19.62it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.005075958091765642\n"],"name":"stdout"},{"output_type":"stream","text":["4403it [03:42, 19.79it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.020451229065656662\n"],"name":"stdout"},{"output_type":"stream","text":["4502it [03:47, 20.12it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.007504072971642017\n"],"name":"stdout"},{"output_type":"stream","text":["4603it [03:52, 19.51it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.07495421171188354\n"],"name":"stdout"},{"output_type":"stream","text":["4703it [03:57, 19.72it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.0560402050614357\n"],"name":"stdout"},{"output_type":"stream","text":["4802it [04:02, 19.46it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.03260453790426254\n"],"name":"stdout"},{"output_type":"stream","text":["4904it [04:07, 19.97it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.004923864733427763\n"],"name":"stdout"},{"output_type":"stream","text":["5004it [04:12, 20.09it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.05719945207238197\n"],"name":"stdout"},{"output_type":"stream","text":["5104it [04:17, 19.77it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.03010585531592369\n"],"name":"stdout"},{"output_type":"stream","text":["5202it [04:22, 20.12it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.031193464994430542\n"],"name":"stdout"},{"output_type":"stream","text":["5304it [04:27, 19.19it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.03459016978740692\n"],"name":"stdout"},{"output_type":"stream","text":["5402it [04:32, 19.83it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.007387555204331875\n"],"name":"stdout"},{"output_type":"stream","text":["5503it [04:37, 19.75it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.017991911619901657\n"],"name":"stdout"},{"output_type":"stream","text":["5603it [04:42, 19.49it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.016287032514810562\n"],"name":"stdout"},{"output_type":"stream","text":["5704it [04:48, 20.00it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.0384598970413208\n"],"name":"stdout"},{"output_type":"stream","text":["5803it [04:53, 19.73it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.015411230735480785\n"],"name":"stdout"},{"output_type":"stream","text":["5903it [04:58, 19.92it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.04052294045686722\n"],"name":"stdout"},{"output_type":"stream","text":["6004it [05:03, 19.00it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.0384146049618721\n"],"name":"stdout"},{"output_type":"stream","text":["6104it [05:08, 19.22it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.030346550047397614\n"],"name":"stdout"},{"output_type":"stream","text":["6202it [05:13, 19.98it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.044829048216342926\n"],"name":"stdout"},{"output_type":"stream","text":["6304it [05:18, 20.15it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.018105430528521538\n"],"name":"stdout"},{"output_type":"stream","text":["6404it [05:23, 19.94it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.04681852087378502\n"],"name":"stdout"},{"output_type":"stream","text":["6504it [05:28, 19.88it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.029087521135807037\n"],"name":"stdout"},{"output_type":"stream","text":["6603it [05:33, 18.93it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.04991907626390457\n"],"name":"stdout"},{"output_type":"stream","text":["6703it [05:38, 19.06it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.05295523256063461\n"],"name":"stdout"},{"output_type":"stream","text":["6804it [05:43, 18.83it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.05642688274383545\n"],"name":"stdout"},{"output_type":"stream","text":["6903it [05:48, 19.83it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.029687434434890747\n"],"name":"stdout"},{"output_type":"stream","text":["7003it [05:53, 19.66it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.029491864144802094\n"],"name":"stdout"},{"output_type":"stream","text":["7104it [05:59, 19.22it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.025763297453522682\n"],"name":"stdout"},{"output_type":"stream","text":["7204it [06:04, 19.18it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.021206319332122803\n"],"name":"stdout"},{"output_type":"stream","text":["7304it [06:09, 19.26it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.014473678544163704\n"],"name":"stdout"},{"output_type":"stream","text":["7403it [06:14, 19.50it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.0065705059096217155\n"],"name":"stdout"},{"output_type":"stream","text":["7503it [06:19, 19.68it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.00859999842941761\n"],"name":"stdout"},{"output_type":"stream","text":["7603it [06:24, 20.07it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.057544611394405365\n"],"name":"stdout"},{"output_type":"stream","text":["7703it [06:29, 20.06it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.006790734361857176\n"],"name":"stdout"},{"output_type":"stream","text":["7802it [06:34, 19.97it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.04324138164520264\n"],"name":"stdout"},{"output_type":"stream","text":["7904it [06:39, 19.69it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.0068207671865820885\n"],"name":"stdout"},{"output_type":"stream","text":["8003it [06:44, 19.79it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.059823885560035706\n"],"name":"stdout"},{"output_type":"stream","text":["8104it [06:49, 19.84it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.1295214593410492\n"],"name":"stdout"},{"output_type":"stream","text":["8202it [06:54, 19.30it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.05964617431163788\n"],"name":"stdout"},{"output_type":"stream","text":["8304it [06:59, 19.91it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.018665149807929993\n"],"name":"stdout"},{"output_type":"stream","text":["8404it [07:04, 19.57it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.044592563062906265\n"],"name":"stdout"},{"output_type":"stream","text":["8504it [07:09, 19.82it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.006658054422587156\n"],"name":"stdout"},{"output_type":"stream","text":["8603it [07:14, 19.82it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.025100387632846832\n"],"name":"stdout"},{"output_type":"stream","text":["8703it [07:20, 19.87it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.03604535385966301\n"],"name":"stdout"},{"output_type":"stream","text":["8803it [07:25, 20.01it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.05040552094578743\n"],"name":"stdout"},{"output_type":"stream","text":["8903it [07:30, 19.85it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.006391205824911594\n"],"name":"stdout"},{"output_type":"stream","text":["9002it [07:35, 19.22it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.02885897271335125\n"],"name":"stdout"},{"output_type":"stream","text":["9104it [07:40, 19.70it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.009387785568833351\n"],"name":"stdout"},{"output_type":"stream","text":["9202it [07:45, 19.43it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.013448351062834263\n"],"name":"stdout"},{"output_type":"stream","text":["9304it [07:50, 19.76it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.0024568652734160423\n"],"name":"stdout"},{"output_type":"stream","text":["9404it [07:55, 19.56it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.03541979193687439\n"],"name":"stdout"},{"output_type":"stream","text":["9502it [08:00, 19.52it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.011166416108608246\n"],"name":"stdout"},{"output_type":"stream","text":["9603it [08:05, 19.89it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.033814381808042526\n"],"name":"stdout"},{"output_type":"stream","text":["9703it [08:10, 20.04it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.04988287016749382\n"],"name":"stdout"},{"output_type":"stream","text":["9804it [08:15, 19.90it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.0317048579454422\n"],"name":"stdout"},{"output_type":"stream","text":["9902it [08:20, 20.18it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.0539175346493721\n"],"name":"stdout"},{"output_type":"stream","text":["10002it [08:25, 20.20it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.03196274861693382\n"],"name":"stdout"},{"output_type":"stream","text":["10104it [08:30, 19.85it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.0353606641292572\n"],"name":"stdout"},{"output_type":"stream","text":["10202it [08:35, 19.55it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.009622829034924507\n"],"name":"stdout"},{"output_type":"stream","text":["10303it [08:40, 19.55it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.044433631002902985\n"],"name":"stdout"},{"output_type":"stream","text":["10404it [08:45, 19.71it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.021919842809438705\n"],"name":"stdout"},{"output_type":"stream","text":["10504it [08:51, 19.46it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.02112535946071148\n"],"name":"stdout"},{"output_type":"stream","text":["10603it [08:55, 20.15it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.02014956623315811\n"],"name":"stdout"},{"output_type":"stream","text":["10702it [09:00, 20.51it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.03157751262187958\n"],"name":"stdout"},{"output_type":"stream","text":["10804it [09:06, 20.07it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.022768640890717506\n"],"name":"stdout"},{"output_type":"stream","text":["10903it [09:11, 20.05it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.08173679560422897\n"],"name":"stdout"},{"output_type":"stream","text":["11003it [09:16, 20.06it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.02145247720181942\n"],"name":"stdout"},{"output_type":"stream","text":["11103it [09:21, 20.20it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.061021797358989716\n"],"name":"stdout"},{"output_type":"stream","text":["11202it [09:26, 19.53it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.013907602988183498\n"],"name":"stdout"},{"output_type":"stream","text":["11304it [09:31, 20.14it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.021467749029397964\n"],"name":"stdout"},{"output_type":"stream","text":["11403it [09:36, 19.92it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.037817373871803284\n"],"name":"stdout"},{"output_type":"stream","text":["11502it [09:41, 19.36it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.02264718897640705\n"],"name":"stdout"},{"output_type":"stream","text":["11604it [09:46, 19.80it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.024665821343660355\n"],"name":"stdout"},{"output_type":"stream","text":["11704it [09:51, 20.03it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.03261625021696091\n"],"name":"stdout"},{"output_type":"stream","text":["11802it [09:56, 19.89it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.037740591913461685\n"],"name":"stdout"},{"output_type":"stream","text":["11904it [10:01, 19.64it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.021876107901334763\n"],"name":"stdout"},{"output_type":"stream","text":["12002it [10:06, 19.28it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.0572362095117569\n"],"name":"stdout"},{"output_type":"stream","text":["12102it [10:11, 19.92it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.032930705696344376\n"],"name":"stdout"},{"output_type":"stream","text":["12204it [10:16, 19.91it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.01888337731361389\n"],"name":"stdout"},{"output_type":"stream","text":["12303it [10:21, 18.93it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.04212268441915512\n"],"name":"stdout"},{"output_type":"stream","text":["12403it [10:26, 19.61it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.04578300565481186\n"],"name":"stdout"},{"output_type":"stream","text":["12504it [10:31, 19.98it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.015632010996341705\n"],"name":"stdout"},{"output_type":"stream","text":["12603it [10:36, 20.13it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.06357519328594208\n"],"name":"stdout"},{"output_type":"stream","text":["12704it [10:41, 19.37it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.017953388392925262\n"],"name":"stdout"},{"output_type":"stream","text":["12804it [10:46, 20.13it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.03372993692755699\n"],"name":"stdout"},{"output_type":"stream","text":["12904it [10:51, 19.71it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.017960771918296814\n"],"name":"stdout"},{"output_type":"stream","text":["13004it [10:56, 19.15it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.01603127270936966\n"],"name":"stdout"},{"output_type":"stream","text":["13104it [11:01, 20.40it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.022366628050804138\n"],"name":"stdout"},{"output_type":"stream","text":["13203it [11:06, 19.53it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.011557058431208134\n"],"name":"stdout"},{"output_type":"stream","text":["13303it [11:12, 19.60it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.04146623611450195\n"],"name":"stdout"},{"output_type":"stream","text":["13403it [11:17, 18.80it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.007307699415832758\n"],"name":"stdout"},{"output_type":"stream","text":["13504it [11:22, 19.32it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.060490742325782776\n"],"name":"stdout"},{"output_type":"stream","text":["13604it [11:27, 19.78it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.039752524346113205\n"],"name":"stdout"},{"output_type":"stream","text":["13704it [11:32, 19.81it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.012869251891970634\n"],"name":"stdout"},{"output_type":"stream","text":["13804it [11:37, 19.47it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.013657649978995323\n"],"name":"stdout"},{"output_type":"stream","text":["13903it [11:42, 19.87it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.026612360030412674\n"],"name":"stdout"},{"output_type":"stream","text":["14004it [11:47, 19.50it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.021209942176938057\n"],"name":"stdout"},{"output_type":"stream","text":["14103it [11:52, 19.75it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.04597454145550728\n"],"name":"stdout"},{"output_type":"stream","text":["14202it [11:57, 20.13it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.03020413964986801\n"],"name":"stdout"},{"output_type":"stream","text":["14304it [12:02, 19.72it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 18, Loss:  0.011692194268107414\n"],"name":"stdout"},{"output_type":"stream","text":["14393it [12:07, 19.79it/s]\n","4it [00:00, 16.91it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.0018140622414648533\n"],"name":"stdout"},{"output_type":"stream","text":["103it [00:05, 19.95it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.040024928748607635\n"],"name":"stdout"},{"output_type":"stream","text":["204it [00:10, 17.00it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.008123732171952724\n"],"name":"stdout"},{"output_type":"stream","text":["303it [00:15, 19.57it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.05084206908941269\n"],"name":"stdout"},{"output_type":"stream","text":["403it [00:20, 19.47it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.02527768537402153\n"],"name":"stdout"},{"output_type":"stream","text":["502it [00:25, 20.30it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.007969164289534092\n"],"name":"stdout"},{"output_type":"stream","text":["602it [00:30, 19.53it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.01338224858045578\n"],"name":"stdout"},{"output_type":"stream","text":["702it [00:35, 19.04it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.04109247028827667\n"],"name":"stdout"},{"output_type":"stream","text":["803it [00:40, 19.46it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.01841462403535843\n"],"name":"stdout"},{"output_type":"stream","text":["904it [00:45, 19.76it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.011423708871006966\n"],"name":"stdout"},{"output_type":"stream","text":["1003it [00:50, 18.66it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.00949861854314804\n"],"name":"stdout"},{"output_type":"stream","text":["1104it [00:56, 19.95it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.017191724851727486\n"],"name":"stdout"},{"output_type":"stream","text":["1204it [01:01, 19.03it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.024574099108576775\n"],"name":"stdout"},{"output_type":"stream","text":["1302it [01:05, 19.80it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.015037443488836288\n"],"name":"stdout"},{"output_type":"stream","text":["1403it [01:11, 19.14it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.042251553386449814\n"],"name":"stdout"},{"output_type":"stream","text":["1503it [01:16, 20.05it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.048280760645866394\n"],"name":"stdout"},{"output_type":"stream","text":["1602it [01:21, 19.55it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.02008148655295372\n"],"name":"stdout"},{"output_type":"stream","text":["1704it [01:26, 19.46it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.012505734339356422\n"],"name":"stdout"},{"output_type":"stream","text":["1804it [01:31, 19.06it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.017294317483901978\n"],"name":"stdout"},{"output_type":"stream","text":["1904it [01:36, 19.63it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.07000544667243958\n"],"name":"stdout"},{"output_type":"stream","text":["2003it [01:41, 19.43it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.06379468739032745\n"],"name":"stdout"},{"output_type":"stream","text":["2103it [01:46, 19.35it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.03303597867488861\n"],"name":"stdout"},{"output_type":"stream","text":["2204it [01:51, 19.28it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.029389025643467903\n"],"name":"stdout"},{"output_type":"stream","text":["2302it [01:56, 20.06it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.020804380998015404\n"],"name":"stdout"},{"output_type":"stream","text":["2404it [02:01, 19.30it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.01686790958046913\n"],"name":"stdout"},{"output_type":"stream","text":["2504it [02:06, 19.19it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.06024348363280296\n"],"name":"stdout"},{"output_type":"stream","text":["2604it [02:11, 19.99it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.04036839306354523\n"],"name":"stdout"},{"output_type":"stream","text":["2703it [02:16, 18.60it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.012398455291986465\n"],"name":"stdout"},{"output_type":"stream","text":["2803it [02:21, 20.02it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.029418325051665306\n"],"name":"stdout"},{"output_type":"stream","text":["2902it [02:26, 19.66it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.14899605512619019\n"],"name":"stdout"},{"output_type":"stream","text":["3003it [02:31, 19.82it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.03325486555695534\n"],"name":"stdout"},{"output_type":"stream","text":["3103it [02:36, 20.01it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.025463448837399483\n"],"name":"stdout"},{"output_type":"stream","text":["3204it [02:42, 19.58it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.01521626953035593\n"],"name":"stdout"},{"output_type":"stream","text":["3303it [02:46, 19.72it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.01866905763745308\n"],"name":"stdout"},{"output_type":"stream","text":["3402it [02:51, 19.52it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.04000169411301613\n"],"name":"stdout"},{"output_type":"stream","text":["3504it [02:57, 19.98it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.019896475598216057\n"],"name":"stdout"},{"output_type":"stream","text":["3604it [03:02, 19.58it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.005175583530217409\n"],"name":"stdout"},{"output_type":"stream","text":["3702it [03:07, 20.36it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.027269478887319565\n"],"name":"stdout"},{"output_type":"stream","text":["3803it [03:12, 19.73it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.04773259907960892\n"],"name":"stdout"},{"output_type":"stream","text":["3903it [03:17, 19.91it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.01138932816684246\n"],"name":"stdout"},{"output_type":"stream","text":["4003it [03:22, 19.98it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.05034491419792175\n"],"name":"stdout"},{"output_type":"stream","text":["4104it [03:27, 19.41it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.0374455600976944\n"],"name":"stdout"},{"output_type":"stream","text":["4203it [03:32, 20.14it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.0028766896575689316\n"],"name":"stdout"},{"output_type":"stream","text":["4304it [03:37, 20.10it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.040137793868780136\n"],"name":"stdout"},{"output_type":"stream","text":["4403it [03:42, 19.45it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.06580890715122223\n"],"name":"stdout"},{"output_type":"stream","text":["4504it [03:47, 20.17it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.02114870771765709\n"],"name":"stdout"},{"output_type":"stream","text":["4602it [03:52, 20.38it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.02213507704436779\n"],"name":"stdout"},{"output_type":"stream","text":["4702it [03:57, 20.12it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.03336600214242935\n"],"name":"stdout"},{"output_type":"stream","text":["4803it [04:02, 20.28it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.04696974158287048\n"],"name":"stdout"},{"output_type":"stream","text":["4903it [04:07, 20.20it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.036186788231134415\n"],"name":"stdout"},{"output_type":"stream","text":["5002it [04:12, 20.07it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.02330169454216957\n"],"name":"stdout"},{"output_type":"stream","text":["5104it [04:17, 19.62it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.059365563094615936\n"],"name":"stdout"},{"output_type":"stream","text":["5203it [04:22, 19.42it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.012590086087584496\n"],"name":"stdout"},{"output_type":"stream","text":["5303it [04:27, 19.66it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.046280983835458755\n"],"name":"stdout"},{"output_type":"stream","text":["5404it [04:32, 19.86it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.03900309279561043\n"],"name":"stdout"},{"output_type":"stream","text":["5504it [04:37, 19.88it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.05965624004602432\n"],"name":"stdout"},{"output_type":"stream","text":["5604it [04:42, 20.40it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.07256855070590973\n"],"name":"stdout"},{"output_type":"stream","text":["5704it [04:47, 19.75it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.00383636518381536\n"],"name":"stdout"},{"output_type":"stream","text":["5802it [04:52, 20.12it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.0075676338747143745\n"],"name":"stdout"},{"output_type":"stream","text":["5904it [04:57, 19.65it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.010719649493694305\n"],"name":"stdout"},{"output_type":"stream","text":["6003it [05:02, 19.46it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.04732034355401993\n"],"name":"stdout"},{"output_type":"stream","text":["6104it [05:07, 19.45it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.024767661467194557\n"],"name":"stdout"},{"output_type":"stream","text":["6203it [05:12, 19.24it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.032538916915655136\n"],"name":"stdout"},{"output_type":"stream","text":["6304it [05:17, 19.08it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.026027023792266846\n"],"name":"stdout"},{"output_type":"stream","text":["6404it [05:23, 19.56it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.020787034183740616\n"],"name":"stdout"},{"output_type":"stream","text":["6504it [05:28, 19.33it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.09322037547826767\n"],"name":"stdout"},{"output_type":"stream","text":["6602it [05:33, 19.65it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.006902232766151428\n"],"name":"stdout"},{"output_type":"stream","text":["6703it [05:38, 18.60it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.020066333934664726\n"],"name":"stdout"},{"output_type":"stream","text":["6804it [05:43, 19.35it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.07471756637096405\n"],"name":"stdout"},{"output_type":"stream","text":["6903it [05:48, 19.39it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.016746629029512405\n"],"name":"stdout"},{"output_type":"stream","text":["7003it [05:53, 19.21it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.037704359740018845\n"],"name":"stdout"},{"output_type":"stream","text":["7103it [05:58, 19.11it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.013832530938088894\n"],"name":"stdout"},{"output_type":"stream","text":["7204it [06:04, 19.95it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.047696802765131\n"],"name":"stdout"},{"output_type":"stream","text":["7304it [06:09, 19.81it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.006403763312846422\n"],"name":"stdout"},{"output_type":"stream","text":["7404it [06:14, 19.64it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.01696261391043663\n"],"name":"stdout"},{"output_type":"stream","text":["7503it [06:19, 19.18it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.010325822979211807\n"],"name":"stdout"},{"output_type":"stream","text":["7603it [06:24, 19.62it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.0040125129744410515\n"],"name":"stdout"},{"output_type":"stream","text":["7704it [06:29, 19.22it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.07063506543636322\n"],"name":"stdout"},{"output_type":"stream","text":["7804it [06:34, 19.50it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.02768176794052124\n"],"name":"stdout"},{"output_type":"stream","text":["7903it [06:39, 19.51it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.005352864041924477\n"],"name":"stdout"},{"output_type":"stream","text":["8004it [06:44, 19.44it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.029225721955299377\n"],"name":"stdout"},{"output_type":"stream","text":["8104it [06:49, 19.45it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.015078612603247166\n"],"name":"stdout"},{"output_type":"stream","text":["8204it [06:54, 19.55it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.03102504089474678\n"],"name":"stdout"},{"output_type":"stream","text":["8303it [07:00, 19.63it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.02413371577858925\n"],"name":"stdout"},{"output_type":"stream","text":["8402it [07:05, 19.64it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.0357729010283947\n"],"name":"stdout"},{"output_type":"stream","text":["8504it [07:10, 19.07it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.01877853088080883\n"],"name":"stdout"},{"output_type":"stream","text":["8603it [07:15, 19.57it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.02551998198032379\n"],"name":"stdout"},{"output_type":"stream","text":["8703it [07:20, 19.60it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.00045715400483459234\n"],"name":"stdout"},{"output_type":"stream","text":["8803it [07:25, 19.62it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.013796646147966385\n"],"name":"stdout"},{"output_type":"stream","text":["8902it [07:30, 19.41it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.005966699682176113\n"],"name":"stdout"},{"output_type":"stream","text":["9003it [07:35, 19.72it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.018485333770513535\n"],"name":"stdout"},{"output_type":"stream","text":["9104it [07:40, 19.91it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.07733321189880371\n"],"name":"stdout"},{"output_type":"stream","text":["9203it [07:45, 19.29it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.022984562441706657\n"],"name":"stdout"},{"output_type":"stream","text":["9304it [07:50, 19.67it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.027539025992155075\n"],"name":"stdout"},{"output_type":"stream","text":["9403it [07:56, 20.04it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.0563683807849884\n"],"name":"stdout"},{"output_type":"stream","text":["9502it [08:01, 19.21it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.04038503021001816\n"],"name":"stdout"},{"output_type":"stream","text":["9602it [08:06, 20.04it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.12313858419656754\n"],"name":"stdout"},{"output_type":"stream","text":["9703it [08:11, 19.80it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.06738932430744171\n"],"name":"stdout"},{"output_type":"stream","text":["9803it [08:16, 19.69it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.029667843133211136\n"],"name":"stdout"},{"output_type":"stream","text":["9902it [08:21, 19.63it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.013738507404923439\n"],"name":"stdout"},{"output_type":"stream","text":["10003it [08:26, 19.33it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.004093519411981106\n"],"name":"stdout"},{"output_type":"stream","text":["10103it [08:31, 19.87it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.008419260382652283\n"],"name":"stdout"},{"output_type":"stream","text":["10203it [08:36, 19.19it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.017259512096643448\n"],"name":"stdout"},{"output_type":"stream","text":["10304it [08:41, 19.44it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.044059328734874725\n"],"name":"stdout"},{"output_type":"stream","text":["10403it [08:46, 18.67it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.055850446224212646\n"],"name":"stdout"},{"output_type":"stream","text":["10503it [08:52, 19.72it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.03892196714878082\n"],"name":"stdout"},{"output_type":"stream","text":["10604it [08:57, 19.30it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.015800457447767258\n"],"name":"stdout"},{"output_type":"stream","text":["10704it [09:02, 19.76it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.01970699056982994\n"],"name":"stdout"},{"output_type":"stream","text":["10804it [09:07, 19.33it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.03978718817234039\n"],"name":"stdout"},{"output_type":"stream","text":["10903it [09:12, 19.25it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.024282993748784065\n"],"name":"stdout"},{"output_type":"stream","text":["11003it [09:17, 19.80it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.034209705889225006\n"],"name":"stdout"},{"output_type":"stream","text":["11103it [09:22, 19.27it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.008781137876212597\n"],"name":"stdout"},{"output_type":"stream","text":["11203it [09:28, 18.74it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.019908852875232697\n"],"name":"stdout"},{"output_type":"stream","text":["11302it [09:33, 19.13it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.12161694467067719\n"],"name":"stdout"},{"output_type":"stream","text":["11404it [09:38, 19.33it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.02126176655292511\n"],"name":"stdout"},{"output_type":"stream","text":["11503it [09:43, 19.51it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.058415673673152924\n"],"name":"stdout"},{"output_type":"stream","text":["11604it [09:48, 19.53it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.044957004487514496\n"],"name":"stdout"},{"output_type":"stream","text":["11703it [09:53, 19.43it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.02676289901137352\n"],"name":"stdout"},{"output_type":"stream","text":["11803it [09:58, 19.39it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.04724095016717911\n"],"name":"stdout"},{"output_type":"stream","text":["11902it [10:03, 19.41it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.1060839295387268\n"],"name":"stdout"},{"output_type":"stream","text":["12003it [10:09, 19.80it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.04671682417392731\n"],"name":"stdout"},{"output_type":"stream","text":["12104it [10:14, 19.07it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.07064111530780792\n"],"name":"stdout"},{"output_type":"stream","text":["12203it [10:19, 19.70it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.005424203351140022\n"],"name":"stdout"},{"output_type":"stream","text":["12304it [10:24, 19.77it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.01967165619134903\n"],"name":"stdout"},{"output_type":"stream","text":["12402it [10:29, 19.74it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.009657149203121662\n"],"name":"stdout"},{"output_type":"stream","text":["12504it [10:34, 19.67it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.07474438101053238\n"],"name":"stdout"},{"output_type":"stream","text":["12603it [10:39, 19.82it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.021654950454831123\n"],"name":"stdout"},{"output_type":"stream","text":["12703it [10:44, 19.50it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.047090671956539154\n"],"name":"stdout"},{"output_type":"stream","text":["12803it [10:49, 19.78it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.019400615245103836\n"],"name":"stdout"},{"output_type":"stream","text":["12904it [10:54, 19.84it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.020731326192617416\n"],"name":"stdout"},{"output_type":"stream","text":["13004it [11:00, 18.95it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.013562475331127644\n"],"name":"stdout"},{"output_type":"stream","text":["13103it [11:05, 19.86it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.012287946417927742\n"],"name":"stdout"},{"output_type":"stream","text":["13204it [11:10, 18.79it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.07564383745193481\n"],"name":"stdout"},{"output_type":"stream","text":["13304it [11:15, 19.80it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.03936737775802612\n"],"name":"stdout"},{"output_type":"stream","text":["13404it [11:20, 19.25it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.021862013265490532\n"],"name":"stdout"},{"output_type":"stream","text":["13504it [11:25, 19.52it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.0238961111754179\n"],"name":"stdout"},{"output_type":"stream","text":["13602it [11:30, 19.49it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.05570350959897041\n"],"name":"stdout"},{"output_type":"stream","text":["13703it [11:35, 19.71it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.020933885127305984\n"],"name":"stdout"},{"output_type":"stream","text":["13802it [11:40, 19.74it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.03348633646965027\n"],"name":"stdout"},{"output_type":"stream","text":["13904it [11:45, 19.14it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.03310638666152954\n"],"name":"stdout"},{"output_type":"stream","text":["14002it [11:50, 20.10it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.039066411554813385\n"],"name":"stdout"},{"output_type":"stream","text":["14104it [11:55, 19.70it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.012426789849996567\n"],"name":"stdout"},{"output_type":"stream","text":["14202it [12:00, 18.92it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.015693817287683487\n"],"name":"stdout"},{"output_type":"stream","text":["14304it [12:06, 20.20it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 19, Loss:  0.02048012614250183\n"],"name":"stdout"},{"output_type":"stream","text":["14393it [12:10, 19.70it/s]\n","4it [00:00, 16.13it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.015253547579050064\n"],"name":"stdout"},{"output_type":"stream","text":["104it [00:05, 19.40it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.021227028220891953\n"],"name":"stdout"},{"output_type":"stream","text":["203it [00:10, 17.78it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.05031834542751312\n"],"name":"stdout"},{"output_type":"stream","text":["302it [00:15, 19.53it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.040447041392326355\n"],"name":"stdout"},{"output_type":"stream","text":["404it [00:20, 20.22it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.02171282470226288\n"],"name":"stdout"},{"output_type":"stream","text":["504it [00:25, 19.74it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.0424494706094265\n"],"name":"stdout"},{"output_type":"stream","text":["604it [00:30, 19.60it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.021631814539432526\n"],"name":"stdout"},{"output_type":"stream","text":["703it [00:35, 19.94it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.040582459419965744\n"],"name":"stdout"},{"output_type":"stream","text":["804it [00:40, 19.34it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.04243272542953491\n"],"name":"stdout"},{"output_type":"stream","text":["904it [00:46, 19.26it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.0253465436398983\n"],"name":"stdout"},{"output_type":"stream","text":["1003it [00:51, 19.52it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.03458188474178314\n"],"name":"stdout"},{"output_type":"stream","text":["1102it [00:56, 20.11it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.007544791791588068\n"],"name":"stdout"},{"output_type":"stream","text":["1204it [01:01, 19.50it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.03453057259321213\n"],"name":"stdout"},{"output_type":"stream","text":["1304it [01:06, 19.54it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.031024057418107986\n"],"name":"stdout"},{"output_type":"stream","text":["1404it [01:11, 19.08it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.01299434807151556\n"],"name":"stdout"},{"output_type":"stream","text":["1504it [01:16, 19.18it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.005680357571691275\n"],"name":"stdout"},{"output_type":"stream","text":["1604it [01:21, 19.33it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.03433720022439957\n"],"name":"stdout"},{"output_type":"stream","text":["1703it [01:26, 19.45it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.05423806607723236\n"],"name":"stdout"},{"output_type":"stream","text":["1803it [01:31, 19.07it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.03101971186697483\n"],"name":"stdout"},{"output_type":"stream","text":["1903it [01:36, 19.33it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.010864567011594772\n"],"name":"stdout"},{"output_type":"stream","text":["2004it [01:42, 18.79it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.0857393890619278\n"],"name":"stdout"},{"output_type":"stream","text":["2103it [01:47, 19.67it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.05251698940992355\n"],"name":"stdout"},{"output_type":"stream","text":["2204it [01:52, 19.33it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.005384492687880993\n"],"name":"stdout"},{"output_type":"stream","text":["2303it [01:57, 19.50it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.0026733677368611097\n"],"name":"stdout"},{"output_type":"stream","text":["2404it [02:02, 19.31it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.01900939829647541\n"],"name":"stdout"},{"output_type":"stream","text":["2504it [02:07, 19.79it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.004934794269502163\n"],"name":"stdout"},{"output_type":"stream","text":["2604it [02:12, 19.33it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.012653916142880917\n"],"name":"stdout"},{"output_type":"stream","text":["2703it [02:17, 19.36it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.007711331360042095\n"],"name":"stdout"},{"output_type":"stream","text":["2804it [02:22, 19.32it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.018892310559749603\n"],"name":"stdout"},{"output_type":"stream","text":["2903it [02:28, 19.07it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.012109927833080292\n"],"name":"stdout"},{"output_type":"stream","text":["3004it [02:33, 19.74it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.07722737640142441\n"],"name":"stdout"},{"output_type":"stream","text":["3102it [02:38, 19.81it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.02262447588145733\n"],"name":"stdout"},{"output_type":"stream","text":["3203it [02:43, 19.59it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.007325369399040937\n"],"name":"stdout"},{"output_type":"stream","text":["3302it [02:48, 19.33it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.0022815146949142218\n"],"name":"stdout"},{"output_type":"stream","text":["3404it [02:53, 19.66it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.058467283844947815\n"],"name":"stdout"},{"output_type":"stream","text":["3504it [02:58, 20.04it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.012713518925011158\n"],"name":"stdout"},{"output_type":"stream","text":["3602it [03:03, 19.77it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.025013845413923264\n"],"name":"stdout"},{"output_type":"stream","text":["3703it [03:08, 19.67it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.08573424071073532\n"],"name":"stdout"},{"output_type":"stream","text":["3803it [03:13, 19.60it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.016338059678673744\n"],"name":"stdout"},{"output_type":"stream","text":["3904it [03:19, 19.59it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.017496153712272644\n"],"name":"stdout"},{"output_type":"stream","text":["4002it [03:24, 19.57it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.0345633402466774\n"],"name":"stdout"},{"output_type":"stream","text":["4104it [03:29, 19.94it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.020818540826439857\n"],"name":"stdout"},{"output_type":"stream","text":["4202it [03:34, 19.61it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.026746541261672974\n"],"name":"stdout"},{"output_type":"stream","text":["4302it [03:39, 19.33it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.04714753478765488\n"],"name":"stdout"},{"output_type":"stream","text":["4403it [03:44, 19.90it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.015350966714322567\n"],"name":"stdout"},{"output_type":"stream","text":["4502it [03:49, 19.40it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.022581402212381363\n"],"name":"stdout"},{"output_type":"stream","text":["4604it [03:54, 19.81it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.05210341513156891\n"],"name":"stdout"},{"output_type":"stream","text":["4702it [03:59, 19.64it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.02240404672920704\n"],"name":"stdout"},{"output_type":"stream","text":["4804it [04:04, 19.30it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.019796520471572876\n"],"name":"stdout"},{"output_type":"stream","text":["4903it [04:09, 19.80it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.019851136952638626\n"],"name":"stdout"},{"output_type":"stream","text":["5003it [04:14, 19.74it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.022281162440776825\n"],"name":"stdout"},{"output_type":"stream","text":["5104it [04:19, 19.26it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.02030731551349163\n"],"name":"stdout"},{"output_type":"stream","text":["5204it [04:24, 20.11it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.029671695083379745\n"],"name":"stdout"},{"output_type":"stream","text":["5303it [04:30, 19.50it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.008062317036092281\n"],"name":"stdout"},{"output_type":"stream","text":["5403it [04:35, 19.29it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.02974524348974228\n"],"name":"stdout"},{"output_type":"stream","text":["5504it [04:40, 19.61it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.02321275696158409\n"],"name":"stdout"},{"output_type":"stream","text":["5602it [04:45, 19.56it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.01711566001176834\n"],"name":"stdout"},{"output_type":"stream","text":["5704it [04:50, 19.49it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.008857417851686478\n"],"name":"stdout"},{"output_type":"stream","text":["5804it [04:55, 19.71it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.03751559555530548\n"],"name":"stdout"},{"output_type":"stream","text":["5903it [05:00, 19.71it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.028913669288158417\n"],"name":"stdout"},{"output_type":"stream","text":["6004it [05:05, 20.04it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.01462623756378889\n"],"name":"stdout"},{"output_type":"stream","text":["6103it [05:10, 19.81it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.0487007312476635\n"],"name":"stdout"},{"output_type":"stream","text":["6203it [05:15, 20.00it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.05366336554288864\n"],"name":"stdout"},{"output_type":"stream","text":["6302it [05:20, 19.60it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.0030671427957713604\n"],"name":"stdout"},{"output_type":"stream","text":["6403it [05:25, 19.74it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.07065705209970474\n"],"name":"stdout"},{"output_type":"stream","text":["6503it [05:30, 19.71it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.02228056825697422\n"],"name":"stdout"},{"output_type":"stream","text":["6603it [05:35, 19.44it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.015932373702526093\n"],"name":"stdout"},{"output_type":"stream","text":["6704it [05:41, 19.81it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.04100462794303894\n"],"name":"stdout"},{"output_type":"stream","text":["6804it [05:46, 19.51it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.013070804998278618\n"],"name":"stdout"},{"output_type":"stream","text":["6903it [05:51, 18.91it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.008900126442313194\n"],"name":"stdout"},{"output_type":"stream","text":["7004it [05:56, 18.69it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.002940199803560972\n"],"name":"stdout"},{"output_type":"stream","text":["7104it [06:01, 19.65it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.059564463794231415\n"],"name":"stdout"},{"output_type":"stream","text":["7202it [06:06, 19.83it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.003687057178467512\n"],"name":"stdout"},{"output_type":"stream","text":["7303it [06:11, 19.82it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.03133557736873627\n"],"name":"stdout"},{"output_type":"stream","text":["7404it [06:16, 19.23it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.04038020968437195\n"],"name":"stdout"},{"output_type":"stream","text":["7503it [06:21, 19.40it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.0022812956012785435\n"],"name":"stdout"},{"output_type":"stream","text":["7603it [06:26, 18.78it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.005634272005409002\n"],"name":"stdout"},{"output_type":"stream","text":["7702it [06:31, 20.43it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.021812696009874344\n"],"name":"stdout"},{"output_type":"stream","text":["7804it [06:36, 19.28it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.0014453220646828413\n"],"name":"stdout"},{"output_type":"stream","text":["7902it [06:41, 19.64it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.016771985217928886\n"],"name":"stdout"},{"output_type":"stream","text":["8004it [06:46, 18.84it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.02930619567632675\n"],"name":"stdout"},{"output_type":"stream","text":["8103it [06:52, 19.04it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.0074679059907794\n"],"name":"stdout"},{"output_type":"stream","text":["8204it [06:57, 19.36it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.07476881891489029\n"],"name":"stdout"},{"output_type":"stream","text":["8303it [07:02, 19.94it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.009799374267458916\n"],"name":"stdout"},{"output_type":"stream","text":["8403it [07:07, 19.27it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.04390714690089226\n"],"name":"stdout"},{"output_type":"stream","text":["8504it [07:12, 19.40it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.017718398943543434\n"],"name":"stdout"},{"output_type":"stream","text":["8603it [07:17, 19.24it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.008658360689878464\n"],"name":"stdout"},{"output_type":"stream","text":["8704it [07:22, 19.87it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.05906401947140694\n"],"name":"stdout"},{"output_type":"stream","text":["8803it [07:27, 19.57it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.01722484827041626\n"],"name":"stdout"},{"output_type":"stream","text":["8902it [07:32, 19.62it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.005240133032202721\n"],"name":"stdout"},{"output_type":"stream","text":["9004it [07:37, 18.76it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.03832022473216057\n"],"name":"stdout"},{"output_type":"stream","text":["9102it [07:42, 18.51it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.009332003071904182\n"],"name":"stdout"},{"output_type":"stream","text":["9204it [07:48, 19.50it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.00942709855735302\n"],"name":"stdout"},{"output_type":"stream","text":["9303it [07:53, 18.90it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.016788367182016373\n"],"name":"stdout"},{"output_type":"stream","text":["9402it [07:58, 19.70it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.003566083265468478\n"],"name":"stdout"},{"output_type":"stream","text":["9503it [08:03, 19.92it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.02482457458972931\n"],"name":"stdout"},{"output_type":"stream","text":["9602it [08:08, 18.99it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.07109476625919342\n"],"name":"stdout"},{"output_type":"stream","text":["9703it [08:13, 19.59it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.050847411155700684\n"],"name":"stdout"},{"output_type":"stream","text":["9804it [08:18, 19.60it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.02856438234448433\n"],"name":"stdout"},{"output_type":"stream","text":["9903it [08:23, 19.99it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.04003869742155075\n"],"name":"stdout"},{"output_type":"stream","text":["10004it [08:28, 19.22it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.0028428896330296993\n"],"name":"stdout"},{"output_type":"stream","text":["10102it [08:33, 20.11it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.03079969249665737\n"],"name":"stdout"},{"output_type":"stream","text":["10203it [08:38, 19.25it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.03249011188745499\n"],"name":"stdout"},{"output_type":"stream","text":["10303it [08:43, 19.66it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.02992456592619419\n"],"name":"stdout"},{"output_type":"stream","text":["10403it [08:48, 20.16it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.044206734746694565\n"],"name":"stdout"},{"output_type":"stream","text":["10504it [08:54, 19.78it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.11229588091373444\n"],"name":"stdout"},{"output_type":"stream","text":["10603it [08:59, 19.51it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.04422023147344589\n"],"name":"stdout"},{"output_type":"stream","text":["10704it [09:04, 19.71it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.02068353071808815\n"],"name":"stdout"},{"output_type":"stream","text":["10804it [09:09, 20.31it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.009403442963957787\n"],"name":"stdout"},{"output_type":"stream","text":["10904it [09:14, 20.12it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.02384575456380844\n"],"name":"stdout"},{"output_type":"stream","text":["11004it [09:19, 19.45it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.012809582985937595\n"],"name":"stdout"},{"output_type":"stream","text":["11103it [09:24, 19.87it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.031847234815359116\n"],"name":"stdout"},{"output_type":"stream","text":["11204it [09:29, 19.87it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.009299849160015583\n"],"name":"stdout"},{"output_type":"stream","text":["11303it [09:34, 19.60it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.007305717561393976\n"],"name":"stdout"},{"output_type":"stream","text":["11404it [09:39, 19.91it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.030047893524169922\n"],"name":"stdout"},{"output_type":"stream","text":["11503it [09:44, 20.25it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.037679389119148254\n"],"name":"stdout"},{"output_type":"stream","text":["11604it [09:49, 19.81it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.017576154321432114\n"],"name":"stdout"},{"output_type":"stream","text":["11703it [09:54, 19.64it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.014026697725057602\n"],"name":"stdout"},{"output_type":"stream","text":["11804it [09:59, 19.69it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.007817912846803665\n"],"name":"stdout"},{"output_type":"stream","text":["11904it [10:04, 19.68it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.023519054055213928\n"],"name":"stdout"},{"output_type":"stream","text":["12003it [10:09, 19.59it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.011457815766334534\n"],"name":"stdout"},{"output_type":"stream","text":["12103it [10:14, 19.77it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.005208276677876711\n"],"name":"stdout"},{"output_type":"stream","text":["12204it [10:20, 20.19it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.03808337450027466\n"],"name":"stdout"},{"output_type":"stream","text":["12304it [10:25, 19.81it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.03680151700973511\n"],"name":"stdout"},{"output_type":"stream","text":["12402it [10:30, 19.61it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.05232549086213112\n"],"name":"stdout"},{"output_type":"stream","text":["12503it [10:35, 19.66it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.08253449201583862\n"],"name":"stdout"},{"output_type":"stream","text":["12603it [10:40, 19.35it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.03762568160891533\n"],"name":"stdout"},{"output_type":"stream","text":["12704it [10:45, 20.16it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.020273327827453613\n"],"name":"stdout"},{"output_type":"stream","text":["12803it [10:50, 19.59it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.016004100441932678\n"],"name":"stdout"},{"output_type":"stream","text":["12903it [10:55, 19.77it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.021305054426193237\n"],"name":"stdout"},{"output_type":"stream","text":["13004it [11:00, 19.67it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.010845072567462921\n"],"name":"stdout"},{"output_type":"stream","text":["13103it [11:05, 19.76it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.03896114230155945\n"],"name":"stdout"},{"output_type":"stream","text":["13204it [11:10, 19.93it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.095797099173069\n"],"name":"stdout"},{"output_type":"stream","text":["13303it [11:15, 19.30it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.08060077577829361\n"],"name":"stdout"},{"output_type":"stream","text":["13402it [11:20, 19.68it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.03735014796257019\n"],"name":"stdout"},{"output_type":"stream","text":["13503it [11:26, 20.13it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.05682367458939552\n"],"name":"stdout"},{"output_type":"stream","text":["13602it [11:31, 19.56it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.011301402002573013\n"],"name":"stdout"},{"output_type":"stream","text":["13703it [11:36, 19.64it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.03163984417915344\n"],"name":"stdout"},{"output_type":"stream","text":["13804it [11:41, 19.79it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.020229093730449677\n"],"name":"stdout"},{"output_type":"stream","text":["13904it [11:46, 19.53it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.02691793069243431\n"],"name":"stdout"},{"output_type":"stream","text":["14003it [11:51, 19.64it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.06123233214020729\n"],"name":"stdout"},{"output_type":"stream","text":["14102it [11:56, 19.18it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.051763612776994705\n"],"name":"stdout"},{"output_type":"stream","text":["14204it [12:01, 20.18it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.008416324853897095\n"],"name":"stdout"},{"output_type":"stream","text":["14302it [12:06, 19.44it/s]"],"name":"stderr"},{"output_type":"stream","text":["Epoch: 20, Loss:  0.005374270491302013\n"],"name":"stdout"},{"output_type":"stream","text":["14393it [12:11, 19.68it/s]\n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"FPkB7j-4o0zC","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1606360842918,"user_tz":300,"elapsed":565,"user":{"displayName":"Zhounan Li","photoUrl":"","userId":"12163187697439231323"}},"outputId":"c14db1b9-ff8f-43e0-e363-b53f7f480a82"},"source":["!lscpu\n"],"execution_count":39,"outputs":[{"output_type":"stream","text":["Architecture:        x86_64\n","CPU op-mode(s):      32-bit, 64-bit\n","Byte Order:          Little Endian\n","CPU(s):              2\n","On-line CPU(s) list: 0,1\n","Thread(s) per core:  2\n","Core(s) per socket:  1\n","Socket(s):           1\n","NUMA node(s):        1\n","Vendor ID:           GenuineIntel\n","CPU family:          6\n","Model:               85\n","Model name:          Intel(R) Xeon(R) CPU @ 2.00GHz\n","Stepping:            3\n","CPU MHz:             2000.122\n","BogoMIPS:            4000.24\n","Hypervisor vendor:   KVM\n","Virtualization type: full\n","L1d cache:           32K\n","L1i cache:           32K\n","L2 cache:            1024K\n","L3 cache:            39424K\n","NUMA node0 CPU(s):   0,1\n","Flags:               fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ss ht syscall nx pdpe1gb rdtscp lm constant_tsc rep_good nopl xtopology nonstop_tsc cpuid tsc_known_freq pni pclmulqdq ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt aes xsave avx f16c rdrand hypervisor lahf_lm abm 3dnowprefetch invpcid_single ssbd ibrs ibpb stibp fsgsbase tsc_adjust bmi1 hle avx2 smep bmi2 erms invpcid rtm mpx avx512f avx512dq rdseed adx smap clflushopt clwb avx512cd avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves arat md_clear arch_capabilities\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"I3woBw0kkUA3"},"source":[""],"execution_count":null,"outputs":[]}]}